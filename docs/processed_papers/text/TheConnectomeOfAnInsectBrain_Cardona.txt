TITLE: Europe PMC Funders Group

ABSTRACT: Brains contain networks of interconnected neurons and so knowing the network architecture

FULL TEXT:

--- PAGE 1 ---
Europe PMC Funders Group
Author Manuscript
Science. Author manuscript; available in PMC 2023 May 16.
Published in final edited form as:
Science. 2023 March 10; 379(6636): eadd9330. doi:10.1126/science.add9330.
The connectome of an insect brain
Michael Winding1,2,3,*, Benjamin D. Pedigo4, Christopher L. Barnes5,2, Heather G.
Patsolic6,7, Youngser Park8, Tom Kazimiers3,9, Akira Fushiki3,10, Ingrid V. Andrade11,
Avinash Khandelwal3, Javier Valdes-Aleman1,3, Feng Li3, Nadine Randel1,2, Elizabeth
Barsotti2,5, Ana Correia5,2, Richard D. Fetter3,12, Volker Hartenstein11, Carey E. Priebe6,8,
Joshua T. Vogelstein4,8,*, Albert Cardona2,5,3,*, Marta Zlatic2,1,3,*
1University of Cambridge, Department of Zoology, Cambridge, UK
2MRC Laboratory of Molecular Biology, Neurobiology Division, Cambridge, UK
3Janelia Research Campus, Howard Hughes Medical Institute, Ashburn, VA, USA
4Johns Hopkins University, Department of Biomedical Engineering, Baltimore, MD, USA
5University of Cambridge, Department of Physiology, Development, and Neuroscience,
Cambridge, UK
6Johns Hopkins University, Department of Applied Mathematics and Statistics, Baltimore, MD,
USA
7Accenture, Arlington, VA, USA
8Johns Hopkins University, Center for Imaging Science, Baltimore, MD, USA
9kazmos GmbH, Dresden, Germany
10Zuckerman Mind Brain Behavior Institute, Columbia University, New York, NY, USA
11University of California Los Angeles, Department of Molecular, Cell and Developmental Biology,
Los Angeles, CA, USA
12Stanford University, Stanford, CA, USA
Abstract
Brains contain networks of interconnected neurons and so knowing the network architecture
is essential for understanding brain function. We therefore mapped the synaptic-resolution
connectome of an entire insect brain (Drosophila larva) with rich behavior, including learning,
value computation, and action selection, comprising 3016 neurons and 548,000 synapses.
exclusive licensee American Association for the Advancement of Science. No claim to original US government works. https://
www.sciencemag.org/about/science-licenses-journal-article-reuseThis work is licensed under a CC BY 4.0 International license.
*Corresponding author. mjw226@cam.ac.uk (M.W.); jovo@jhu.edu (J.T.V.); mzlatic@mrc-lmb.cam.ac.uk (M.Z.); acardona@mrc-
lmb.cam.ac.uk (A.C.).
Author contributions Conceptualization: M.W., B.D.P., C.E.P., J.T.V., M.Z., and A.C. Neuron Reconstruction: M.W., A.F., I.V.A.,
A.K., J.V.A., F.L., N. R., E.B., and A.C. Methodology: M.W., B.D.P., C.L.B., H.G.P., Y.P., T.K., R.F., V.H., C.E.P., J.T.V., and A.C.
Analysis: M.W., B.D.P., C.L.B. Supervision: M.W., C.E.P., J.T.V., M.Z., and A.C. Writing: M.W., B.D.P., M.Z., and A.C. Writing -
Review and editing: M.W., B.D.P., R.F., V.H., C.E.P., J.T.V., M.Z., and A.C.
Competing interests: The authors declare that they have no competing interests.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 2 ---
Winding et al. Page 2
We characterized neuron types, hubs, feedforward and feedback pathways, as well as
cross-hemisphere and brain-nerve cord interactions. We found pervasive multisensory and
interhemispheric integration, highly recurrent architecture, abundant feedback from descending
neurons, and multiple novel circuit motifs. The brain's most recurrent circuits comprised the
input and output neurons of the learning center. Some structural features, including multilayer
shortcuts and nested recurrent loops, resembled state-of-the-art deep learning architectures. The
identified brain architecture provides a basis for future experimental and theoretical studies of
neural circuits.
Introduction
One of the brain's defining characteristics is its synaptic wiring diagram, or connectome. A
synapse-resolution connectome is therefore an essential prerequisite for understanding the
mechanisms of brain function (1, 2). To date, complete synaptic-resolution connec-tomes
have only been mapped for three organisms with up to several hundred brain neurons
(3–5). Reconstructing and proof-reading circuits from larger brains has been extremely
challenging. Synapse-resolution circuitry of larger brains has therefore been approached
only considering select subregions (6–8). However, pervasive interconnectivity has been
observed between brain regions (9, 10). Large-scale recording of functional activity in
invertebrates (11) and vertebrates (12) demonstrates that neural computations occur across
spatially dispersed brain regions, highlighting the need for brain-wide circuit studies.
We therefore sought to generate a comprehensive synapse-resolution connectivity map of
a relatively complex brain of a small insect that has a rich behavioral repertoire and is
experimentally tractable. We settled on the 1st instar larva of Drosophila melanogaster,
which has a compact brain with several thousand neurons that can be imaged at the
nanometer scale with electron microscopy (EM) and its circuits reconstructed within a
reasonable time frame. Its brain structures are homologous to those of adult Drosophila
and larger insects of other species (13–15). The 1st instar larva already has as rich a
repertoire of adaptive behaviors as the 3rd instar (16–18), including short- and long-term
memory (13, 19, 20), value computation, and action selection (19, 21–23). Furthermore,
the circuit architecture is stable throughout larval stages (24). Thus, although neurons grow
in size to accompany the growth of the body, they maintain the fraction of synapses they
receive from specific partners. Finally, an exceptional genetic toolkit and transparent body
make the Drosophila larva an excellent model for manipulating and recording activity in
specific neurons in freely behaving animals and relating structural motifs to their function
(19, 21–23, 25–27). We mapped all neurons of a Drosophila larva brain and annotated
their synapses using computer-assisted reconstruction with CATMAID (see Methods) in a
nanometer-resolution EM volume of the central nervous system (CNS) (23).
Results
Reconstruction of the Drosophila larva brain in a full-CNS electron microscopy volume
We previously generated a synaptic-resolution EM volume of the CNS of a 1st instar
Drosophila larva (23, 28). This volume contains all CNS neurons, as well as sensory
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 3 ---
Winding et al. Page 3
neuron axons and motor neuron dendrites, enabling reconstruction of all neural pathways
from sensory input to motor output. Previous studies have used this EM volume to
reconstruct most sensory inputs to the brain (455 neurons), their downstream partners, and
the higher-order learning center (total 1054 brain neurons). We reconstructed the remaining
1507 neurons in the brain. The resulting dataset contains 480 input neurons and 2536
differentiated brain neurons (3016 neurons total), and ~548,000 synaptic sites (Fig. 1, A and
B, and fig. S1, A to D). Most neurons (>99%) were reconstructed to completion, and the
majority of annotated synaptic sites in the brain (75%) were linked with a neuron (Fig. 1B).
The remaining 25% were mostly composed of small dendritic fragments, reconstruction of
which is labor-intensive. Moreover, prior studies have shown that neurons make multiple
connections with the same partner on different dendritic branches (24, 28), so orphaned
synapses may affect synaptic weights of known connections but are unlikely to add entirely
new strong connections or change conclusions about strongly connected pathways.
Most neurons in Drosophila are mirrored across hemispheres, such that each neuron has
a hemilateral homolog in the opposite hemisphere (28). We identified all homologous
hemilateral partners using automated graph matching (29–31) followed by manual review.
These pairings were robust across a variety of independent morphological and connectivity
metrics (fig. S1, E and F). Our data suggest that 93% of brain neurons have hemilateral
homologous partners in the opposite hemisphere (Fig. 1C). Kenyon cells (KC) (176 neurons)
in the learning and memory center comprise most unpaired neurons (13).
These homologous partners were used to identify potential reconstruction errors and
to target proofreading to such neurons (fig. S1D). To assess the effectiveness of this
targeted proofreading, we randomly selected ten brain interneurons and fully proofread
them according to previously described methods (23, 28). Most (74%) neuron→neuron
connections, or edges, remained unchanged. Edges that did change after proofreading
mostly displayed a modest increase in synaptic strength, suggesting errors of omission,
which were previously described as the most common type of error (28, 32) (fig. S1, G
and H). In the following sections, we investigate neuron and connection types, the flow of
information from inputs to outputs, multisensory integration, cross-hemisphere interactions,
feedback from outputs to inputs, and the level of recurrence in the brain and brain-nerve
cord interactions.
Identification of all brain input neurons, interneurons, and output neurons
To facilitate the analysis of the connectome, we identified a set of broad neuron classes
based on prior information. Brain neurons were divided into three general categories: input
neurons, output neurons, and interneurons (Fig. 1, D and E). Brain input neurons (Fig. 1F)
comprise two broad classes: (i) sensory neurons (SNs) with axons in the brain (33–35), and
(ii) ascending neurons (ANs; fig. S2) that transmit somatosensory signals from the ventral
nerve cord (VNC) (23, 36–38). Brain output neurons comprise three broad classes: those
with axons terminating in the ring gland (RGNs), descending to the SEZ (DNsSEZ), or
descending into the VNC (DNsVNC) (Fig. 1H). The full set of RGNs have been previously
described (35, 36, 39), whereas DNsSEZ and DNsVNC were reconstructed and identified here
based on axon projections (fig. S3).
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 4 ---
Winding et al. Page 4
Brain interneurons comprised all neurons with cell bodies and axons and dendrites in the
brain. We subdivided interneurons into classes based on previously known functional role or
direct connectivity with neurons of known functional role (Fig. 1G and fig. S4). We started
with sensory input neurons and identified their projection neurons (PNs) in the primary
sensory neuropils and the neurons postsynaptic of these PNs in the brain center for encoding
innate valences (the lateral horn, LH). We used the previously characterized neurons of
the learning center [the mushroom body (MB)], including: the KCs that sparsely represent
stimulus identities; MB output neurons (MBONs) that represent learned valences of stimuli;
MB modulatory input neurons (MBINs, mostly dopaminergic, DANs) that provide teaching
signals for learning; and their input neurons (MB feedforward neurons, MB-FFN) (19);
MB feedback neurons (MB-FBNs that connect MBONs and MBINs) (19); and convergence
neurons (CN) that integrate learned and innate valences from the MB and LH (21). We also
identified all presynaptic partners of the three output neuron types.
Identification of all axons and dendrites in the brain
To better understand neuron morphology, we identified all axons and dendrites. In
Drosophila, axons and dendrites contain most of a neuron's presynaptic and postsynaptic
sites, respectively, and are separated by a linker domain devoid of synapses. We used
an established strategy to identify the synapse-devoid linker domains (see Methods) (28).
Axonic and dendritic compartments were defined as distal or proximal to these linker
domains, respectively. These data were manually proofread, and an axon-dendrite split
point was placed for each neuron. We determined that 95.5% of the brain (2421 neurons)
are polarized with an identifiable axon and dendrite, 0.5% (13 neurons) are unpolarized
with no definable axon, and 4.0% (102 neurons) are immature (Fig. 2A). These immature
neurons were not the developmentally arrested, small undifferentiated (SU) neurons that
later differentiate into adult neurons (40) and their nuclei were not heterochromatin-rich like
those of SU neurons, despite their general lack of arborization or synaptic sites. It is likely
that these immature neurons started to differentiate but were still in the process of neurite
outgrowth and polarization when the sample was collected. This population includes 78
immature KCs (13) but also 24 non-KC immature neurons, revealing limited neurogenesis of
larval neurons outside the memory and learning center.
All polarized neurons segregated pre- and post-synaptic sites within axons and dendrites,
respectively (Fig. 2B). However, we also found that axons often contained postsynaptic sites
and dendrites contained presynaptic sites. Thus, neurons can synapse directly onto axons
and dendrites can directly synapse onto other neurons.
Four connection types: axo-dendritic, axo-axonic, dendro-axonic and dendro-dendritic
Whereas axo-dendritic connections are well established in the literature, other nonca-nonical
interactions such as axo-axonic connectivity (13, 41–44) and dendritic output (13, 45–47)
have been observed but are not as well studied, and their prevalence was unknown. We
therefore identified all axodendritic (a-d), axo-axonic (a-a), dendro-dendritic (d-d), and
dendro-axonic (d-a) connections in the brain. Most synapses were a-d (66.6%) or a-a
(25.8%); however, there were still many d-d (5.8%) and d-a synaptic sites (1.8%, Fig. 2C).
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 5 ---
Winding et al. Page 5
Most (71.8%) of brain neurons received some level of reproducible axonic modulation (fig.
S5). Notably, 95 neurons (3.8%) received especially large amounts of axonic input relative
to output (fig. S5, A and B), including subsets of KCs, DANs, and predescending neurons
(pre-DNsVNC). Neurons that make dendritic output onto other neurons were much rarer
(16.5%), but some made an especially large amount of dendritic output relative to input,
including subsets of KCs and predescending neurons (fig. S5, C and D).
The connectome can be thought of as four graphs (Fig. 2D), where all four graphs share
the same set of nodes (i.e., neurons), and the four edge types (a-d, a-a, d-d, and d-a)
each comprise a separate graph. We quantified the number of neurons (nodes), the density,
and maximum node degree for each graph (Fig. 2E). The axo-dendritic graph had the
highest density (i.e., the most connections) and highest number of neurons participating
in connectivity, whereas the axo-axonic graph had the highest maximum degree (i.e., the
maximum number of synaptic partners observed in an individual neuron).
We next wondered whether neurons were connected by one or multiple edge types. Most
neuron partners (95%) were connected in only one way (a-d, a-a, d-d, or d-a). However,
we also observed many edges with multiple connection types (fig. S6D), which occurred
more often than expected by a null model. The most common examples were a-d combined
with a-a, however many combinations were observed, including rare combinations of three-
or four-edge types between the same neurons. Four-edge connections were mostly found
in local neurons (LNs, i.e., neurons involved in local processing in a specific neuropil)
and predescending neurons, whereas three-edge connections were more dispersed amongst
multiple cell types, but with a focus in LNs and predescending neurons (fig. S6E).
Numerically strong connections are reproducible across brain hemispheres
We investigated the distribution of edge strengths for each connection type (fig. S6, A and
B). Most edges were weak (1 or 2 synapses) for all connection types (a-d: 60%, a-a: 75%,
d-d: 79%, d-a: 91%; 66% across all types). However, strong edges (≥5 synapse) contained
the majority (a-d: 61%; across all types: 55%; fig. S6B), whereas weak edges (1 or 2
synapses) contained the minority (a-d: 22%; across all types: 28%) of synaptic sites.
We next investigated edge symmetry across the two brain hemispheres. Edge strength
correlated with interhemispheric symmetry (fig. S6C): weak edges were mostly
asymmetrical whereas strong edges were highly conserved between hemispheres. With edge
strengths of at least 5 and 10 synapses, most edges (>80 and >95%, respectively) were
symmetrical across all edge types. Similarly, weak, variable connections were observed in C.
elegans (48). Given that many weak connections are not reproducible between hemispheres,
we cannot discern whether the observed sto-chasticity is due to reconstruction error or
developmental noise (28). We therefore focus much of our analysis on strong reproducible
connections (see Methods). However, weak connections could have notable roles, such
as maintaining a certain membrane potential (49), adding noise (50) or contributing to
idiosyncratic variability in behavior.
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 6 ---
Winding et al. Page 6
Distinct connection types differentially contribute to feedforward and feedback pathways
We studied the contribution of different edge types to either feedforward or feedback
signals throughout the brain. We applied the signal flow algorithm (see Methods) to the
graph with all edge types combined to sort neurons according to the flow from sensory
to descending neurons. We used this input-to-output sorting to categorize connections in
the brain: we defined connections as feedforward if they projected from neurons closer to
sensory periphery to neurons closer to descending neurons, and vice versa for feedback
edges. The a-d graph displayed the most feedforward synapses; a-a and d-d graphs displayed
a mixture of feedforward and feedback, with a bias toward feedforward synapses; whereas
the d-a graph displayed the most feedback synapses (Fig. 2F and fig. S6, F and G).
We next compared neuron sortings when performed on each of the four graphs
independently (Fig. 2G and fig. S7). The sorting of the a-d graph best matched the summed
graph (graph with all edge types combined) and sorted the network from sensory periphery
to brain output neurons. The a-a and a-d graphs displayed a similar flow from sensory to
output, despite the details of the sorting being different (Spearman's correlation coefficient
= 0.44 between the signal flow sorting of the a-a and a-d graphs). Notably, the d-a graph
sorting tended to be the inverse of the a-d graph's (Spearman's correlation coefficient =
–0.61), i.e., starting at brain output neurons and ending at the sensory periphery. Most d-a
edges (63%) were the inverse of a-d edges (i.e., there was a high edge reciprocity; Fig. 2H),
which explains the inverse relationship between these graphs.
A-a and to a lesser extent d-d connections displayed high edge reciprocity, meaning many
neurons displayed reciprocal a-a connections and d-d connections, respectively (Fig. 2H).
Note that because all connections are directional, such reciprocal loops were not guaranteed
to occur.
Hierarchical clustering estimates 93 connectivity-based brain neuron types
Next, we subdivided brain neurons into types based on their synaptic connectivity. We used
the graph structure of all four connection types to spectrally embed all brain neurons in a
shared space and clustered them using this representation (see Methods). This resulted in
nested sets of clusters that can be examined at a desired granularity, from large groups of
neurons to 93 fine-grained cell types (Fig. 3A and fig. S8, A to D). In contrast with results
from community detection algorithms, our clusters are not necessarily composed of groups
of neurons which communicate more densely within a cluster (see Methods). Instead, our
clustering grouped neurons with similar connectivity to other neurons even if little direct
intracluster connectivity was present—for example, olfactory PNs from the antennal lobe
which function as parallel input channels and whose activity is regulated as a group (33).
Thus, our approach is better suited to finding neuron types, rather than densely connected
processing modules. Our connectivity-based clusters were internally consistent for attributes
besides connectivity. The morphology of neurons within clusters was similar, with the mean
within-cluster NBLAST score (0.80 ± 0.15 SD) much higher than expected by chance (0.5),
even though clustering was based solely on connectivity and no morphological data were
used (Fig. 3B and fig. S8, A and B). Furthermore, neurons with similar known functions
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 7 ---
Winding et al. Page 7
were usually found in the same or in related clusters (e.g., clusters of olfactory PNs, KCs,
MBINs/MBONs, MB-FBNs, and others; Fig. 3A and fig. S8, D to G).
The connectivity within and between all clusters is displayed in Fig. 3C. Many (but
not all) clusters displayed strong intracluster connectivity and shared output to similar
postsynaptic clusters. A coarser granularity can also be selected (Fig. 3D) and used to
explore connectivity between larger groups of related neuron types.
Most brain hubs are pre- or postsynaptic to the learning center
Hubs play key roles in brain computations and behavior (51). We therefore identified
brain hubs for all connection types. To focus on the strongest hubs, reproducible across
hemispheres, we filtered the connectome to include only strong connections observed in
both hemispheres (using a ≥1% input threshold; see Methods). Brain hubs were defined
as having ≥20 pre- or postsynaptic partners, respectively, i.e., an in- or out-degree of ≥20
[this threshold is based on the a-d network mean plus 1.5 standard deviations (SD)]. We
distinguished between in-hubs (over the in-degree threshold), out-hubs (over the out-degree
threshold), and in-out hubs (over both thresholds). Using these criteria, we identified 506
a-d, 100 a-a, 10 d-d, and 8 d-a hubs (Fig. 3E and fig. S9). a-d out-hubs were often observed
in clusters closer to the sensory periphery, notably PNs, whereas a-d in-hubs were more
often closer to output clusters, including pre-output and output neurons. Most (73%, 19
of 26 pairs) of a-d in-out hubs were postsynaptic to the learning center output neurons
(MBONs) and/or presynaptic to its modulatory neurons that drive learning (MBONs, CNs,
MB-FBNs, MB-FFNs, and one pre-DNVNC pair postsynaptic to MBONs; Fig. 3F). Several
in-out hubs (23%, 12 pairs) were convergence neurons (CNs), receiving input from both the
MB and LH, which encode learned and innate values, respectively (19, 21). One such in-out
hub is the CN-MBON-m1, shown to functionally integrate learned and innate values and
bidirectionally control approach and avoidance (21).
Identification of all brain local neurons
Brain neurons are often divided into local neurons (LNs), involved in local processing within
a specific brain neuropil or layer, and PNs, which carry information to other brain regions.
To systematically identify all brain LNs, we developed two connectivity-based definitions
(fig. S10, A and B). Type 1 LNs provide most of their output to neurons in their sensory
layer (defined by the number of hops from SNs of a particular modality), and/or to the
sensory layer directly upstream of them (fig. S10A). Type 2 LNs received most of their input
and sent most of their output to any sensory layer, to which it did not belong (fig. S10B).
In this way, we identified all previously published LNs (13, 33, 34) and many new putative
LNs (fig. S10, C and D). We then defined all 2nd order PNs by exclusion, i.e., all neurons
that were not local but were directly downstream of SNs (fig. S10E). Non-LN neurons that
are higher order (i.e., not directly downstream of SNs) are usually termed output neurons
from a specific neuropile (13, 52, 53) rather than PNs, but we refrain from labeling them
in a specific way and leave them undefined as non-LNs. Although our LN definitions were
connectivity-based, they provided results that matched morphological expectations. Namely,
the Euclidean distance between the axon and dendrite of local neurons was small, whereas
for PNs the axon-dendrite distance was large (fig. S10F). Notably, LNs engaged in more
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 8 ---
Winding et al. Page 8
noncanonical connectivity than PNs, including a-a, d-d, and d-a connections (fig. S10G),
perhaps allowing LNs to regulate multiple aspects of activity in both the axon and dendrite.
Most of the LNs (98 neurons) that met the above definition were either 2nd order neurons
directly downstream of SNs (i.e., one hop from SNs) or 3rd order neurons (two hops
downstream of SNs; fig. S10C). A very small number of 4th-order LNs were also identified
(6 neurons; fig. S10, C and D). Two of the three pairs were pre-DNVNC neurons and one was
downstream of neurons that integrate learned and innate valence, suggesting some level of
local processing in the pre-DNVNC and post-MB flayers. Overall, progressively fewer LNs
were found further from the sensory periphery.
Identification of all brain sensory pathways
We systematically characterized brainwide pathways from distinct types of SNs to all
other brain neurons. For the remainder of the paper, we will focus our analysis on a-d
connections because they are the most abundant and best understood in terms of functional
effects. We generated all possible a-d pathways from brain input neurons to all other
brain neurons and ending at output neurons in fewer than 6 hops (Fig. 3G). We classified
input neurons based on their known sensory modalities. Olfactory (33), gustatory (35),
thermosensory (54), visual (34), gut (35), and respiratory state SNs (55) project directly to
the brain. Somatosensory ANs from the nerve cord received direct or indirect input from
mechanosensory (22, 23), nociceptive (23, 56), and proprioceptive SNs (28) (fig. S2 and
table S1) and their axons projected to the brain.
We identified all 2nd-, 3rd-, 4th-, and 5th-order brain neurons downstream of each input
modality (Fig. 4, A to C). For the purpose of this analysis, we defined the order of a neuron
according to its lowest order input from any input neuron type. However, neurons can
receive multipath input from the same input neuron type, through distinct paths of different
lengths (e.g., they can be both 2nd-and 3rd-order). Many brain neurons (545; 21%) were
2nd order, but most (1410; 56%) were 3rd order (received input from a SN in two hops). A
considerable number were 4th order (377; 15%), but only 16 neurons (<1%) were 5th order
(Fig. 4C). Note that 188 brain neurons (7%) were either immature or received only input
from neurons in the SEZ of unknown modality and were therefore not categorized. Of the
neurons analyzed, no brain neuron was more than 4 hops removed from at least one input
neuron and most were only 2 or 3 hops removed.
Most 2nd-order neurons received direct input from a single SN type (Fig. 4B), with some
exceptions, including olfactory local neurons that also received input from gustatory and
thermowarm SNs (33, 54). 3rd-order neurons were more often shared across modalities and
by the 4th order, most neurons were shared across modalities (Fig. 4B). However, even
neurons that are exclusively 2nd or 3rd order for one modality can receive input from other
modalities through longer paths.
Most sensory modalities exhibited a large expansion of neuron numbers in the 3rd order,
compared with 2nd-order layers (Fig. 4A and table S2), indicating prominent divergence,
i.e., they broadcast their signals to many different downstream partners. Generally, the
number of neurons downstream of 2nd-order PNs (divergence) was higher than the number
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 9 ---
Winding et al. Page 9
of PNs upstream of the 3rd-order neurons (convergence). Convergence was also prominent,
with most 3rd-order neurons receiving input from multiple 2nd-order PNs.
Sensory information can reach output neurons within one to three hops
We investigated the cell type identities of neurons at different processing layers, i.e., at
different hops from SNs or ANs (2nd-, 3rd-, 4th-and 5th-order neurons) within each sensory
circuit (Fig. 4C). Sensory information reached all cell classes within a couple hops. A
notable percentage of brain output neurons were 2nd order, i.e., postsynaptic (one hop) of
SNs or ANs (DNsVNC: 13%, DNsSEZ: 53%, RGNs: 46%), or 3rd order, i.e., two hops from
SNs or ANs (DNsVNC: 52%, DNsSEZ: 38%, RGNs: 29%). The remaining 34% of DNsVNC,
5% of DNsSEZ, and 21% of RGNs were 4th order (three hops from SNs/ANs, Fig. 4C).
Thus, most output neurons receive sensory information within a maximum of three hops.
However, although these direct (one-hop), two-hop, or three-hop connections represent the
shortest paths to output neurons, most output neurons also received longer multihop input
from SNs.
The highest order neurons in the brain (5th order) were not output neurons, but contained 14
pre-output neurons, presynaptic to DNsVNC. These neurons received input from and output
to other pre-DNsVNC (the most numerous group of 4th-order neurons) and shared some
upstream and downstream partners, suggesting complex, multilayered connectivity between
pre-DNsVNC (fig. S11). This suggests that, even though DNVNC neurons can receive sensory
input in very few hops, they also receive the most processed information in the brain through
longer paths. We observed multiple parallel pathways from each sensory modality to DNs
(fig. S12, A and B). However, we also found extensive connectivity between neurons within
these parallel pathways, suggesting they likely form a distributed processing network (fig.
S12C). Most pathways and most individual neurons within paths were not restricted to a
particular sensory modality and were instead shared by multiple modalities (fig. S12, D and
E).
Different sensory modalities targeted different types of output neurons (Fig. 4C). For
example, gustatory and gut sensory signals targeted more DNsSEZ than DNsVNC, whereas
other modalities targeted more DNsVNC than DNsSEZ. Generally, sensory pathways to
DNsSEZ were shorter compared with pathways to DNsVNC. Most DNsSEZ were 2nd order
(receiving direct inputs from SNs) whereas most DNsVNC were 3rd order.
Output neurons receive input from the same modality through multiple paths of varying
lengths
Sensory information is processed both serially and in parallel (57) but the architecture
of sensory circuits is not fully understood. While characterizing the shortest paths from
SNs to output neurons, we observed that output neurons also receive sensory information
through longer paths. The additional hops in longer paths likely result in further processing
of the stimulus, which may be important to extract more abstract features (58, 59) or to
layer more complex computations on top of existing ones (60). To provide a basis for a
comprehensive understanding of sensory processing circuits, we therefore systematically
analyzed all pathways and not just the shortest ones.
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 10 ---
Winding et al. Page 10
We developed a computational tool, the signal cascade, that propagates polysynaptic signals
through the brain based on the assumption that the likelihood of signal propagation between
two connected neurons depends on the number of synapses between them (Fig. 4D; see
Methods). Synapse counts can be used to accurately predict synaptic surface area and
are therefore a good proxy for synaptic strength (61). This tool therefore captures all
polysynaptic pathways with reasonably strong connections along their length. The algorithm
makes no assumption about the sign of connections and assumes that both excitatory and
inhibitory connections can influence the activity of downstream neurons relative to baseline
activity. In support of this assumption, patch-clamp recordings show that larval neurons
have baseline activity that can be bidirectionally modified (19, 22) and direct optogenetic
inhibition; further, activation of neurons relative to their own baseline can promote opposite
actions (21).
Signals can be started and terminated at predefined neurons to explore all pathways that link
them. We use brain output neurons as end points unless otherwise mentioned. In cascades
started at SNs, the signal generally reached DNsVNC in 3 to 6 hops and rarely more than
8 hops (Fig. 4E), which we therefore considered the maximum depth of the brain. 5-hop
pathways were shown to be functional in the larva (specifically, MD class IV neurons to
MB DANs) (19), but no studies have yet functionally tested 6-, 7-, or 8-hop pathways. We
therefore stop the cascades at either 8 or 5 hops, using 8 hops to not miss long paths and
5 hops to determine which aspects of architecture are apparent with a pathway length for
which functional connectivity has been confirmed.
Using 8-hop cascades, we identified all pathways between SNs or ANs and output neurons
(Fig. 4E). Individual sensory modalities had different median pathway depths to output
neurons (fig. S13A). Overall, olfaction and gustation displayed the shortest pathways to
output neurons, whereas the ascending somatosensory modalities displayed the longest.
Output neurons received sensory inputs from the same modality through multiple paths
of different lengths. For example, some paths from the same sensory modality reached
DNsVNC in 2 hops, whereas others displayed as many as 6 hops (fig. S13A). DNsVNC, on
average, received input from pathways of three different lengths from individual sensory
modalities (Fig. 4F and fig. S13B).
Most brain neurons are multimodal
We next investigated the multimodal character of the brain as a whole, while taking into
account the longer pathways. We started 8-hop signal cascades from each sensory modality
and reported the combinations of sensory input each neuron received (fig. S13, C and D).
Very few neurons (12 or 14% with 8- or 5-hop cascades, respectively) received signals from
only one modality, purported labeled line neurons, whereas most neurons were multimodal
(Fig. 4G), including brain output neurons (fig. S13, E and F). Most labeled line neurons
were close to the sensory periphery (Fig. 4H). Nevertheless, many modalities converged
already at the earliest stages of sensory processing, with only 36 or 38% (with 8- and
5-hop cascades) of 2nd-order PNs/PNssomato being unimodal (fig. S13C). Consistently, we
observed multimodal mixing between different sensory circuits at the 2nd, 3rd, 4th, and 5th
orders (fig. S13D).
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 11 ---
Winding et al. Page 11
We also analyzed sensory convergence on MB DANs. DANs have been implicated in
learning, motivation, and action-selection across the animal kingdom (62) and understanding
the type of sensory information they receive is essential for understanding their function.
DANs receive input from sensory systems that sense rewards and punishments (19, 63), but
the extent to which they receive input from other modalities was unclear. We found that
DANs received input from all sensory modalities, including from those that normally sense
conditioned stimuli in learning tasks (e.g., olfactory) and from proprioceptive neurons (with
5- or 8-hop cascades; Fig. 4I). By contrast, other MB modulatory neurons (13) were not
as integrative: only 33% (with 5- or 8-hop cascades) of octopaminergic neurons (OANs)
received input from all modalities.
Identification of all ipsilateral, bilateral, and contralateral neurons
The presence of two hemispheres is a fundamental property of the brain, but the way in
which information from both hemispheres is integrated and used in neural computation is
not well understood. To investigate the structural basis of interhemispheric interactions, we
identified all neurons that engaged in interhemispheric communication through contralateral
projections (axonal or dendritic, Fig. 5, A and B). Most (98%) of neurons displayed
ipsilateral dendrites (fig. S14). A small population of neurons (1%) had bilateral dendrites
with either ipsilateral, bilateral, or contralateral axons. These neurons were only observed
in the learning center (MBONs) and brain output network (pre-DNsVNC, DNsVNC, DNsSEZ)
(fig. S15). Although most neurons had ipsilateral (61%) a substantial number had bilateral
(24%) or contralateral (15%) axons (Fig. 5C). Notably, 88% of a-d in-out hubs had either
contra- or bilateral axons, even though these neurons account for only 39% of brain neurons.
Some neurons with bilateral axons target distinct partners in the two hemispheres
Neurons with bilateral axons project to both hemispheres, but do they communicate
with homologous postsynaptic partners in both hemispheres? We calculated the cosine
similarity between postsynaptic partners of individual bilaterally projecting neurons in the
two hemispheres (Fig. 5D, left). Most bilateral neurons generally connected to homologous
partners in both hemispheres, i.e., had high partner similarity scores, but there were some
neurons that had low scores. We binned these neurons into three categories based on their
partner similarity scores and analyzed their partners further (Fig. 5D, right; fig. S16).
We found 7 pairs of bilateral neurons with completely different postsynaptic partners on
the ipsi- and contralateral hemispheres and 13 pairs with mostly non-overlapping ipsi-
and contralateral partners (fig. S16). All of these neurons had unilateral dendrites. Most
asymmetric bilateral neurons synapsed onto pre-DNs or DNs in one hemisphere but not the
other, or onto different DNs or pre-DNs in the two hemispheres. These neurons could be
involved in controlling asymmetric motor patterns that require activation of different subsets
of muscles on the left and right sides of the body. Indeed, some DNs that receive input from
asymmetric bilateral neurons (fig. S16, C and D) have presynaptic sites in thoracic and early
abdominal segments, perhaps indicating a role in turning (64).
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 12 ---
Winding et al. Page 12
Reciprocal contralateral loops
To better understand information flow between brain hemispheres, we asked how ipsilateral,
bilateral, and contralateral neurons communicate with each other and calculated their
connection probability (Fig. 5E). Ipsilateral neurons synapsed approximately equally onto
ipsilateral, bilateral, and contralateral neurons in the ipsilateral hemisphere. Bilateral
neurons had a slight preference for bilateral and contralateral neurons. Contralateral neurons
displayed a notable preference for other contralateral neurons, both in terms of input and
output. Individual contralateral neurons synapsed onto 3.4 other contralateral neurons on
average (34% of their downstream partners), whereas ipsilateral neurons synapsed onto 1.5
contralateral neurons on average (15% of their downstream partners).
Because each contralateral neuron has a homolog in the opposite hemisphere, we wondered
whether homologous left-right contralateral neuron pairs tended to directly synapse onto
each other. We found that the connection probability onto a homologous contralateral
partner was much higher than onto a nonhomologous neuron (Fig. 5F). We identified 24
reciprocally connected homologous pairs (10% of contralateral neurons; fig. S17). Most
were either pre-DNsVNC, DNsVNC, postsynaptic of the learning center outputs (MBONs),
and/or provided feedback onto the MB DANs (figs. S17D and S18). Many homologous pair
loops interacted amongst themselves, forming double or super loops (fig. S18B). Double
and super loops occurred between neuron pairs with similar morphology and/or connectivity.
One super loop involved four neuron pairs downstream of the in-out hub, MBON-m1, which
integrates input from other MBONs and from the LH (21) and computes predicted values
of stimuli. This super loop projected onto pre-DNsVNC and indirectly sent feedback onto
MB DANs through MB-FBNs (fig. S18C). The other super loop involved five neurons
that projected onto DNsVNC. Thus, the reciprocal pair loops, double loops, and super
loops appear to be prevalent in brain areas that potentially play a role in action-selection
(downstream of MBONs and upstream of DNsVNC) and learning (upstream of MB DANs).
Interhemispheric integration occurs across most of the brain
Our finding that 39% of brain neurons have contra- or bilateral axons suggests that the
two hemispheres are heavily interconnected and that their information could be integrated
at many sites. To systematically investigate where interhemispheric convergence occurs, we
generated signal cascades from either left-or right-side SNs and observed the resulting signal
propagation through both hemispheres (fig. S19, A to C). Signals crossed to the opposite
hemisphere within 2 hops and were robustly found in both hemispheres by 3 hops (fig.
S19A). We assessed simultaneous overlap between left- and right-side sensory signals to
find interhemispheric integration sites. The cell types of all integrative ipsilateral, bilateral,
and contralateral types were identified (fig. S19B). We quantified the lateralization of each
neuron by the ratio of left and right signals they received through signal cascades. Most
neurons (81 or 79%, using 8- or 5-hop cascades) integrated signals from both left and right
SNs (fig. S19C). Most lateralized neurons were PNs, KCs, and DNsSEZ (Fig. 5G). Thus,
after integration of contralateral- and ipsilateral information on one side of the brain, the
integrated information is often passed back to the other hemisphere (fig. S19, D to I).
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 13 ---
Winding et al. Page 13
Analysis of brainwide pathways reveals a nested recurrent architecture
The dominant synaptic network of the brain comprised a-d connections (Fig. 2C), many
of which provide feedforward signal from sensory to output systems (Fig. 2F). However,
recurrence is an important feature of brain circuits (19, 65) and can improve computational
power in artificial neural nets (66). We therefore characterized the reverse signal in the a-d
network, from output neurons back toward the sensory periphery. We generated independent
signal cascades starting at each level-7 brain cluster (Figs. 6A and 3A). Because these
clusters were sorted from brain inputs to outputs, we could track the extent to which signals
propagated up or down this brain structure to other clusters. We kept these cascades short
(ending after 2 hops) to initially limit our analysis to the shorter paths of reverse signal
and identify its lower bound. A cascade signal that traveled up the brain cluster structure
toward the sensory periphery was considered backward, whereas a signal that traveled down
the cluster structure toward the output neurons was considered forward. Robust forward and
backward signal originated from nearly all brain clusters (Fig. 6B). Deeper brain clusters
(closer to brain outputs) received mostly forward signals, whereas shallower clusters (closer
to sensory periphery) received a mixture of forward and backward signals. Most brain
clusters provided forward and backward signals to multiple other clusters simultaneously;
this was observed even for single neurons within each cluster (Fig. 6C).
We wondered to what extent individual neurons provide feedback to their own upstream
partners, thereby forming recurrent loops. We therefore used multihop signal cascades from
individual neurons to identify their direct and indirect downstream partners throughout
the brain (up to 5 hops). We then determined which of these downstream partners sent
recurrent signals back to the source neuron. We found that 41% of brain neurons were
recurrent, i.e., sent signals back to at least one of their upstream partners (Fig. 6D).
Furthermore, downstream neurons often sent recurrent signals to upstream neurons using
paths of multiple different lengths (Fig. 6E). On average, recurrent communication between
a single downstream neuron and its upstream partner used polysynaptic paths of multiple
different lengths (on average 1.9 ± 0.9 SD).
Input and output neurons of the learning center are among the most recurrent in the brain
We next analyzed which brain cell classes were the most recurrent (Fig. 6F). We define
recurrence for individual neurons as the fraction of their polysynaptic downstream partners
(using cascades of up to 5 hops) that sent signal back to that source neuron (also using 5-hop
cascades) with a-d connections. Therefore, neurons with high and low recurrence scores are
engaged in many and few recurrent loops, respectively.
The fraction of recurrent partners varied widely between distinct neuron classes (Fig. 6F).
PNs and the intrinsic neurons of the learning center (KCs) had virtually no recurrent partners
(on average, 1.2% and 0.1%, respectively). Other neurons associated with the learning
center were amongst the most recurrent in the brain: DANs (57%), the modulatory neurons
that drive learning; MB-FBNs (51%), presynaptic to DANs and implicated in computing
predicted value and regulating learning (19); MBONs (45%), the outputs of the learning
center and presynaptic to MB-FBNs; and CNs (42%), presynaptic to both MBONs and
LHNs, which integrate learned and innate signals (21) (Fig. 6F). Together, these four sets of
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 14 ---
Winding et al. Page 14
neurons implicated in learning (13, 19) and in memory-based action-selection (21) form a
set of interconnected recurrent loops (Fig. 6, F and G).
Descending neurons provide efference copy to learning center dopaminergic neurons
Many deep brain clusters far from the sensory periphery (Fig. 6B), including many DNs,
provided backward signals to many brain neurons. The axons of some DNsVNC (37%)
and most DNsSEZ (66%) synapsed onto other brain neurons before descending to the
VNC and SEZ, thus providing putative efference copy signals (i.e., copies of motor
commands). Single DNs broadcasted signals to neurons that were directly or indirectly
upstream of themselves (feedback signals) or onto parallel pathways, namely neurons
upstream of other output neurons (parallel efference copy signals; Fig. 6H). DNs synapsed
onto many different brain neurons (Fig. 6H), including 130 postsynaptic partners and 588
partners 2 hops downstream of DNsVNC and 320 postsynaptic partners and 1284 partners
2 hops downstream of DNsSEZ. Of those DNs that synapsed onto brain neurons, we found
that individual DNsVNC synapsed on average onto 6 postsynaptic neurons and indirectly
(through 2 hops) onto 43 neurons. Individual DNsSEZ synapsed on average onto 8 neurons
directly and onto 79 neurons in 2 hops.
We investigated the cell type identities of brain neurons receiving DNSEZ and DNVNC
input (Fig. 6H). The most prominent DNSEZ targets were PNs [including direct connections
to an olfactory uniglomerular PN (uPN 67b), 5 pairs of multi-glomerular PNs, 24 pairs
of gustatory PNs] and pre-DNVNC neurons. The most prominent DNsVNC targets were
pre-DNVNC neurons and MB-related neurons thought to play a role in memory-based action
selection (CNs) (21) and in driving learning: MBINs (mostly dopaminergic, DANs) and
FBNs that integrate MBON input and feed it back onto the MBINs (19) (Fig. 6H). DNsVNC
also synapsed onto a few PNs (2 nociceptive and 2 gut/mechanosensory PN pairs) and 4
pairs of MB-FFNs (which carry sensory signals to DANs and OANs) (Fig. 6H).
Signal cascades revealed that all DANs and most of their upstream MB-FBNs (90%) receive
feedback signals from DNsVNC (fig. S20, A to D), forming larger recurrent loops. DANs
even received direct or 2-hop input from DNsVNC. DNsVNC also sent robust feedback to
MB-FBNs, that are presynaptic to MBINs/DANs (fig. S20C).
Brain-nerve cord projectome provides a basis for studying how the brain controls actions
Our EM volume contains the complete CNS (brain, SEZ, and nerve cord), allowing us to
assess communication between the brain and the rest of the CNS. Because most motor
neurons (MNs) are located in the VNC, understanding brain-nerve cord communication is
essential to understanding how behavior is generated. We reconstructed axons of brain DNs
that send feedforward signals outside of the brain. We divided the CNS into 13 regions
based on stereotyped landmarks, including all VNC segments, and determined how many
DN presynaptic sites were located in each CNS region (Fig. 7A-i, fig. S21). This resulted
in a brain-VNC projectome directly linked to the connectome. Each VNC segment contains
MNs, which innervate muscles in stereotyped positions throughout the body (Fig. 7A-ii).
Previous studies have identified body segments involved in specific behaviors (Fig. 7A-iii),
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 15 ---
Winding et al. Page 15
such as forward and backward locomotion (11, 64), turning (64), hunching (22, 67), speed
modulation (68), and head movement (69).
Using these linked projectome-connectome data, we generated an overview plot that
displays the following for each DNVNC: (i) its upstream partners; (ii) the location of its
outputs throughout the CNS, and (iii) all its downstream partners in the brain (Fig. 7B-i
to iii). We annotated the projectome plot with candidate behaviors that each DNVNC might
produce (Fig. 7B-ii). We found a strong correlation (Cramer's V Correlation Coefficient =
0.58) between the cluster identity (based on brain connectivity) and nerve cord projection
region for the descending neurons (Fig. 7B-iv), indicating that neurons that project to
distinct nerve cord regions and likely mediate distinct behaviors also receive distinct patterns
of brain input (fig. S22, B and C).
Multiple feedforward pathways of different kinds and different lengths converged onto
DNsVNC (Fig. 7C). There were many short paths through PNs directly onto DNsVNC, longer
paths through the LH, and even longer ones through the MB. Specifically, 19 and 65% of
DNsVNC were directly or 2 hops downstream of PNs, respectively. 11 and 66% were directly
or 2 hops downstream of both PNs and LHNs, respectively. A few DNsVNC were directly
or 2 hops downstream of innate pathways (14%) or downstream of only learning pathways
(3%). However, most DNsVNC (80%) were directly or 2 hops downstream of both neurons
that encode innate (PNs and LHNs) and learned valences (MBONs, CNs, MB-FBNs).
Descending neurons target a small fraction of premotor circuit interneurons in the nerve
cord
The brain projectome reveals which segments DNsVNC project to, but not the way in which
the brain communicates with the VNC circuitry. We analyzed how the brain communicates
with the most completely reconstructed VNC segment (A1), in which all motor (70, 71) and
many sensory circuits (22, 23, 38, 56, 72, 73) have been reconstructed. We identified A1
ascending neurons to the brain (fig. S2) and therefore have all links from the brain to the A1
(through DNsVNC) and from A1 to the brain (through ANsA1; Fig. 7D).
First, we characterized the motor and sensory layering in A1 to determine where DNsVNC
input went onto this structure (Fig. 7, D to F). We quantified the number of hops upstream
of MNs (for motor layering, Fig. 7E) or downstream of SNs (for sensory layering) each
A1 interneuron (Fig. 7F). Of the A1 interneurons, 232 of 342 (68%) had direct or indirect
connections to MNs, whereas 110 (32%) did not. Of those that did, most (198 neurons,
85%) were either directly or 2 hops upstream of MNs, indicating that A1 motor circuits are
relatively shallow (Fig. 7E). Premotor and prepremotor neurons were the most prominent
DNVNC targets (Fig. 7E). Out of the 42 DNsVNC inputting to A1 (DNsVNC-A1), 28 (66.7%)
synapsed onto premotor or prepremotor neurons (fig. S23, A to C). Whereas 2 DNsVNC-A1
(1 pair, 4.8%) synapsed onto an MN, 12 DNsVNC-A1 (28.5%) synapsed onto sensory circuit
neurons (directly or indirectly downstream of A1 SNs, fig. S23, A to C).
Individual DNsVNC synapsed onto relatively few A1 interneurons, with 1.9 (± 1.4 SD)
neurons downstream of each DNVNC and only 48 of 342 A1 neurons (14%) downstream
of all DNsVNC. Similarly, only a small fraction of premotor (12%) and their upstream
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 16 ---
Winding et al. Page 16
prepremotor neurons (17%) were direct targets of DNsVNC (Fig. 7E). Many (71%) of
these pre- and pre-premotor DNVNC targets also received direct or indirect A1 sensory
input, sometimes from multiple modalities. We also asked whether DNVNC targeted A1 hub
neurons (with ≥10 up-or downstream partners based on A1 network mean + 1.5 SD). Indeed,
DNVNC targeted two hubs, namely neurons A03o (in-hub) and A18b (out-hub).
Some descending neurons modulate sensory processing in the nerve cord
The depth of sensory circuits was varied from 3 hops (proprioceptive) to 7 or 8 hops
(nociceptive and chordotonals) from SNs within A1 (Fig. 7F). DNsVNC mostly targeted
3rd or 4th-order SNs (2 or 3 hops downstream of SNs), many of which were also
pre- or prepremotor neurons (31 and 39%, respectively). A notable exception were the
proprioceptive circuits. DNsVNC synapsed onto several 2nd-order proprioceptive neurons
(Fig. 7F), half of which were also pre- or prepremotor neurons.
We categorized DNsVNC into three types based on their direct targets (fig. S23, A to C).
Group 1 (20 neurons, 47.6%) targeted both premotor and 2nd-order SNs. Group 2 (10 DNs,
23.8%) targeted 8 A1 motor circuit neurons (4 pairs) that were not part of sensory circuits
and had axonal outputs mostly restricted to T3-A1 (fig. S23D). Group 3 (12 DNs, 28.6%)
targeted 12 2nd- or 3rd-order A1 SNs (6 pairs) that were not part of A1 motor circuits,
including ANs (2 pairs) and long-range A1 neurons that output collectively to all thoracic
segments and most abdominal segments (fig. S23E). These results suggest that DNVNC
modulation of post-sensory cells is propagated across the CNS, including back to the brain
through ANs, within A1 itself, and across nearly all VNC segments (T1 to T3, A2 to A7).
Direct descending-ascending connectivity reveals novel brain-nerve cord zigzag motifs
To better understand reciprocal brain-nerve cord communication, we analyzed neurons
upstream and downstream of A1 ANs. We observed many instances of direct DNVNC→AN
and AN→DNVNC and AN→DNSEZ connectivity (but no AN→RGN; Fig. 7G and fig.
S24A). Specifically, 12 DNsVNC-A1 (30%) synapsed onto 4 ANs in A1 (11%), whereas
24 ANs in A1 (57%) synapsed onto 22 DNsVNC (12%) and 12 DNsSEZ (7%) in the brain.
To test whether AN-DN and DN-AN connections were a general feature present in other
segments, we assayed connectivity between DNsVNC and all currently reconstructed ANs
from all VNC segments. Individual DNsVNC received 3.6% (± 5.2% SD) of their input from
ANs, with some receiving >20% of their input from ANs (to a maximum of 37%). It should
be noted that this is an underestimate because most ANs from segments other than A1 have
not yet been reconstructed. Conversely, individual ANs across the VNC received 3.1% (±
6.1% SD) input from DNsVNC, with some receiving >20% of their input from descending
neurons (to a maximum of 32%).
Reciprocal loops between DNsVNC and ANs were never observed. Instead, we found zigzag
motifs, DNVNC→AN→DNVNC, with different DNsVNC on each side (Fig. 7, H and I).
Similar motifs were observed involving DNsSEZ (fig. S24, B and C). To obtain further
insight into zigzag motifs, we analyzed the sensory information carried by the A1 ANs
and the behavioral roles of DNs that participate in these motifs. One pair of ANs was
postsynaptic to proprioceptive SNs, whereas the other was highly multimodal and 2 hops
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 17 ---
Winding et al. Page 17
downstream of most SNs (fig. S23, see asterisks). We know the behavioral roles of a small
fraction of DNsVNC (because the driver lines for most have not yet been generated) but we
found one motif with known roles for both DNs (Fig. 7J). This motif contained PDM-DN
(DNVNC) and the MDNs (DNVNC) , which promote stop (74) and backup (15), respectively.
1 2
Stop-backup is a common behavioral sequence (75), raising the possibility that ANs in
zigzag motifs could facilitate transitions between actions in a sequence, based on both brain
inputs and proprioceptive feedback or somatosensory context.
Discussion
We present a synaptic-resolution connectivity map of an entire Drosophila larva brain and
a detailed analysis of the associated brain circuit architecture. Each neuron was split into
two compartments, axon and dendrite, resulting in a rich multiplexed network with four
connection types, facilitating analysis. To characterize long-range brainwide anatomical
pathways, we developed an algorithm that utilizes synapse numbers between neurons to
track signal propagation across polysynaptic pathways.
Connectivity-based clustering reveals 93 distinct types of brain neurons
Neuron types have been classified based on their functional role (19, 21, 76), morphology
(32, 77), gene expression (78), or combinations of features (79, 80). Although these
features are likely correlated, it is still unclear which is ideal for defining neuron types
and how neuron types based on different features correspond to each other. We performed
an unbiased hierarchical clustering of all neurons using synaptic connectivity alone and
identified 93 types. The morphology of neurons within clusters was notably similar.
Furthermore, neurons that had similar known functions were usually found in the same
or related clusters. Thus, clustering neurons based on synaptic connectivity resulted in
clusters that were internally consistent for other features, when those features were known.
However, many clusters contained uncharacterized neurons with unknown gene expression
and function.
Noncanonical connection types are pronounced in learning and action-selection circuits
Although most connections in the brain were a-d (66.4%), we found a significant number of
a-a (26.4%), d-d (5.4%), and d-a (1.8%) connections. Most neurons that received prominent
axonic input were in the learning center: DANs that provide the teaching signals for learning
and KCs that encode stimuli. Modulatory a-a DAN-to-KC input drives heterosynaptic
plasticity of the KC-to-MBON synapse (81). DANs also receive excitatory a-a input
from KCs, which provides positive feedback that facilitates memory formation (41). KCs
also receive a-a input from other KCs. In the adult Drosophila, a-a connections between
otherwise excitatory (cholinergic) KCs were found to be inhibitory due to expression of
inhibitory mAChR-B in axon terminals (82). Lateral inhibition between KCs could improve
stimulus discrimination and reduce memory generalization (13). A subset of pre-DNsVNC
and a few somatosensory PNs, LHNs, and MBONs, and FBNs also had a high axonic input/
output ratio. If a-a connections in these neurons are inhibitory they could enhance contrast
between representations of distinct stimuli and actions (57).
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 18 ---
Winding et al. Page 18
We also observed edges with multiple connection types between neurons, including up to all
four types simultaneously. The most common combination, axo-dendritic with axoaxonic,
may grant the presynaptic neuron post- and presynaptic control of the downstream neuron,
as has been observed in triad motifs in mammals (83).
Pathways from sensory to output neurons form a multilayered distributed network
We observed multiple parallel pathways of varying depths downstream of each modality,
albeit with extensive interconnectivity between different pathways. This architecture
suggests that distinct features may not be processed independently but rather that each
feature may potentially influence the computation of many other features in a distributed
network. Such architecture has the potential to generate a diversity of neural responses with
mixed selectivity for specific combinations of features thereby expanding the dimensionality
of neural representations and increasing output flexibility (84).
We found that the shortest paths from sensory neurons to output neurons are surprisingly
shallow. All output neurons receive input from sensory neurons within a maximum of 3
hops. However, most output neurons also received input from the same modality through
multiple longer pathways. Such an architecture, with connections that skip layers, is
characteristic of prominent machine learning networks (85, 86), including deep residual
learning and U-Net architectures. Although predictive accuracy improves with depth,
features can become too abstract at deep layers leading to performance degradation (87).
Shortcuts between layers can solve this problem by combining lower-level features as an
additional teaching signal (85, 88). Shallower networks with shortcuts can therefore exceed
the performance of deeper networks lacking shortcuts (85). The layer skipping we observed
may therefore increase the brain's computational capacity, overcoming physiological
constraints on the number of neurons that limit network depth.
Recurrent architecture of the brain with multiple nested loops
Recurrence has been observed in many brain circuits and implicated in a range of
computations (65, 89–92). However, the architecture of long-range recurrent pathways and
the nature of the feedback that each neuron receives is still poorly understood. We used
signal cascades to systematically identify all connected pairs of brain neurons (with up to 5
hops) that had a reciprocal connection (of up to 5 hops). We found that 41% of brain neurons
received long-range recurrent input (up to 5 hops) from at least one of their downstream
partners with recurrent pathways of varying lengths forming multiple nested loops.
Recurrent nested structure can compensate for a lack of network depth in artificial neural
networks (66) and supports arbitrary, taskdependent computation depth (93).
Learning center dopaminergic neurons are amongst the most recurrent in the brain
DANs were amongst the most recurrent neurons in the brain. Dopaminergic neurons,
referred to as DANs in insects, are central for learning, motivation, and action across
the animal kingdom (62) and are implicated in a range of human mental disorders (94).
The highly recurrent connectivity of DANs might deliver high-dimensional feedback (95),
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 19 ---
Winding et al. Page 19
enabling them to encode a range of features and flexibly engage in parallel computations.
Recurrent excitatory loops could also play roles in working memory (19, 96–98).
Previous studies have reported that DANs receive extensive feedback from neurons that
integrate learned and innate values (19). We find that DANs also receive long-range
feedback (up to 5 hops) from descending neurons, which likely encode motor commands.
Furthermore, we found that DANs receive polysynaptic feedforward inputs from all sensory
modalities. DAN activity correlates with movement in both vertebrates and flies (99), which
could be explained by the observed input from DNsVNC or from proprioceptive neurons.
Most brain hubs are directly downstream or upstream of the learning center
Hub neurons have been shown to play essential roles in behavior (51, 100). We found
that most (73%) of the larval brain's in-out hubs were postsynaptic to the learning center
output neurons (MBONs) and/or presynaptic to the learning center modulatory neurons
(mostly DANs). Many were also postsynaptic to the LH that mediates innate behaviors, thus
integrating learned and innate values (21). One of these hubs, MBON-m1, has been shown
to compute overall predicted value by comparing input from neurons encoding positive
and negative values (21). MBON-m1 bidirectionally promotes approach or avoidance when
its activity is increased or decreased, respectively. Several additional hubs identified here
have similar patterns of input to MBON-m1, suggesting that they may play similar roles in
computing predicted values. These hubs provide direct feedback to the MB DANs and could
therefore play roles in regulating learning.
Cross-hemisphere interactions
We identified all contralaterally projecting neurons and their connections, providing a basis
for understanding how information from both hemispheres is used by the brain. Notably,
neurons with contralateral axons were disproportionately represented amongst in-out hubs,
suggesting that they have important roles in behavior. Contralateral neurons tended to
synapse onto each other. Thus, after integration of contra- and ipsilateral information in
one hemisphere, the integrated information is often passed back to the other hemisphere.
Multiple consecutive hemisphere crossings could potentially enable better discrimination
between ipsilateral, contralateral, or bilateral events and better coordination between the
two hemispheres. We also discovered multiple reciprocal pair loops between contralateral
left-right homologs. If inhibitory, pair loops could mediate interhemispheric comparisons,
and if excitatory, they could be involved in signal perpetuation or short-term memory (96,
97). Consistent with this idea, many pair loops occurred between neurons presynaptic to the
MB DANs.
Brain and nerve cord interactions
Our study sheds light on brain-nerve cord interactions. DNs targeted only a small fraction
of premotor elements that could play important roles in switching between locomotor
states. A subset of DNs targeted low-order post-sensory interneurons likely modulating
sensory processing. DNs and ANs also synapsed onto each other, often forming zigzag
motifs (DN 1→AN→DN
2
). A recent study has demonstrated that an AN can activate
the downstream DN and drive the same action as the DN (101). Thus, ANs may
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 20 ---
Winding et al. Page 20
facilitate DN activation and transitions between actions based on proprioceptive feedback
or somatosensory context. Somatosensory neurons have been shown to activate descending
neurons in vertebrates (102, 103), raising the possibility that ascending-descending
connectivity may be a general feature of brain-nerve cord interactions.
Materials and Methods
Electron Microscopy Data and Reconstruction
The EM volume of the central nervous system (CNS) of the 6-hour-old Drosophila
melanogaster 1st instar larva used in this study has been previously reported (23, 28).
Briefly, the genotype of this female larva was Canton S G1 [iso] × w1118 [iso] 5905. The
resulting EM volume contains 4841 z-slices with an x,y,z resolution of 3.8 × 3.8 × 50 nm.
This dataset includes the complete CNS, including all neurons, synapses, and accessory
structures. Note that only the axons and dendrites of sensory neurons and motor neurons,
respectively, are present in the volume. However, the morphology and location of these
neurons was sufficient to match them to the respective neurons in whole animal datasets
and thereby identify the identities and modalities of sensory axons (33–35, 104) or the
corresponding muscle targets of motor neurons (71).
We identified the boundaries of the brain hemispheres and all brain neurons using
stereotyped landmarks (105). Neurons and synapses were manually reconstructed by
multiple users using the Collaborative Annotation Tool for Massive Amounts of Imaging
Data, CATMAID (28). Many previous publications have contributed to the reconstruction
of neurons in this CNS (13, 22, 23, 33–35, 71, 73, 104), so the completeness of brain
neurons was first assessed using proofreading status and publication status. A complete
census of the brain was conducted by examining each lineage entry point (105) to identify
all brain cell bodies. Each cell body was then used as a seed point for iterative reconstruction
by multiple users until all arbor end-points were identified. The reconstruction process
generally followed previous descriptions (23, 28), however a targeted proofreading process
was used by comparing left-right homologous neuron pairs. Quantification of the results of
this methodology suggests it produced neuron reconstructions that are robust across multiple
metrics (fig. S1, E and F), although some errors of omission were observed.
Axon and Dendrite Identification
We identified all axons and dendrites using a previously developed algorithm, synapse
flow centrality (SFC) (28). In Drosophila, axons contain most presynaptic sites, whereas
dendrites contain most postsynaptic sites, except for mushroom body Kenyon cells. SFC
finds the shortest physical paths along the neuronal arbor between each pair of presynaptic
and postsynaptic sites in the neuron. The section of arbor that contains the highest number
of these presynaptic-to-postsynaptic paths corresponds to a synapse-devoid region located
between the axon and dendrite that we name the linker domain and which generally
corresponds to the axon initial segment. We used SFC to identify these linker domains in
all brain neurons and assigned the axon-dendrite split point to the most proximal part of the
linker domain. All split points were generated automatically and then manually proofread.
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 21 ---
Winding et al. Page 21
The compartment with the highest postsynaptic to presynaptic site ratio (the dendrite) was
always located closer to the soma.
Threshold to focus on strong, reproducible (symmetrical) connections
Some of the weak (1- or 2-synapse) connections could be erroneous, transient, or not
functional. Given that many are not reproducible between the left and right hemispheres,
we cannot discern whether the observed sto-chasticity is due to errors in reconstruction
or developmental noise in establishing new synapses or retracting them (28). We therefore
focus much of our analysis on the strong reproducible (symmetrical) connections.
Strong reproducible (symmetrical) connections are defined as those that are observed
between homologous pre- and postsynaptic partners in both brain hemispheres (e.g., if
a connection is observed between left-side pre- and postsynaptic neurons, a connection
must also be observed between the matching right-side pre- and postsynaptic neurons).
Additionally, these connections must account for on average ≥1% input onto the dendrite in
axo-dendritic connections. Note that a connection in one brain hemisphere can be <1%, as
long as the connection on the opposite side is strong enough to compensate and both are
observed. For example, a 0.5% connection and a 2% connection result in a mean connection
strength of 1.25%, which passes the 1% threshold. Any analysis indicating use of a ≥1%
input threshold uses this left-right thresholding approach.
However, it should be noted that weak connections could have notable functional roles,
such as helping maintain a certain desirable membrane potential (49) or adding noise
for computation (50). They could also contribute to idiosyncratic differences in behavior
between individuals.
Clustering
We developed a modified spectral clustering procedure to cluster brain neurons based on
connectivity. To achieve clustering in which homologous left and right neuron pairs are
likely to be in the same cluster (as opposed to having clusters comprised of left-only or
right-only neurons), we developed a technique to perform a spectral embedding which
collapses left and right symmetry into a single embedding space. First, the network was
split into four subgraphs: connections from neurons on the left side to neurons on the left
side (LL), from right to right (RR), from left to right (LR), and from right to left (RL).
Each subgraph had its edge weights transformed using a procedure called pass-to-ranks, a
regularization scheme which replaces each edge weight with its normalized rank among
all edges and is helpful for spectral embedding in the context of outliers or skewed
edge weight distributions (106–108). We then embed each subgraph into a d-dimensional
Euclidean space (d = 24) using the adjacency spectral embedding (ASE) as implemented
in Graspologic (107, 108). Because of an orthogonal nonidentifiability associated with the
latent position estimates from ASE (107), we used a joint optimal transport/orthogonal
Procrustes procedure (109) to align the latent positions of the LL and RR subgraphs, and
separately the LR and RL subgraphs. This procedure yields a representation for each node in
terms of its ipsilateral (LL or RR) inputs and outputs, as well as its contralateral (LR or RL)
inputs and outputs. To achieve a single representation for each node which is amenable to
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 22 ---
Winding et al. Page 22
clustering, we concatenated each of these representations per node, and performed another
singular value decomposition to further project each node into a lower-dimensional space
(d = 10). Finally, to ensure that homologous neuron pairs are clustered the same way, we
average the embeddings for a left and right node (note that most of these points were already
close in this embedded space due to the procedure described above).
With this representation for each neuron, we clustered using a hierarchical approach
to Gaussian mixture models (GMM) inspired by past work on hierarchical stochastic
block models (110, 111). GMM on an ASE embedding was recently shown to be a
consistent way of estimating the membership assignments for a statistical network model
called the stochastic block model, motivating this approach (107, 112). We use a Python
implementation of GMM with model selection (113, 114). In the hierarchical paradigm, all
neurons currently under consideration are clustered using a 1-component and 2-component
GMM. The fit of both models is evaluated using the Bayesian information criterion (BIC)
metric (115), which is commonly used to select the number of clusters in a GMM (116). If
the 2-component model is preferred by the BIC score and the number of neurons is not too
small (32 neurons is chosen as the cutoff), then the set of neurons under consideration is
split according to this clustering. This procedure recursed until the depth of the “cluster tree”
reached eight, yielding a multiresolution clustering of brain connectivity.
Finding homologous neuron pairs through graph matching
We employed a family of techniques based on the Fast Approximate Quadratic (FAQ) graph
matching algorithm (30, 31) to predict bilateral neuron pairs on the basis of connectivity.
These algorithms seek to find a 1-to-1 alignment of one network's adjacency matrix with
respect to another which minimizes the norm of their difference. In this case, the two
adjacency matrices were the induced subgraphs (all connections among a specified subset
of nodes) of the left and right hemispheres (i.e., the ipsilateral connections) of the brain.
We used 406 groundtruth neuron pairs from previous publications (13, 21, 33) as seeds,
specifying a fixed, partial alignment between the two networks. The seeded graph matching
algorithm was randomly initialized 50 times (while preserving the known matching from the
ground truth pairs). Predicted pairs from each initialization of the algorithm were recorded.
We then ranked potential pairs according to how often they were matched to each other,
manually reviewing each potential pair for correctness. This process was iterated multiple
times, with newly identified pairs added to the population of seed pairs, until all reasonable
pairings were exhausted.
Quantifying similarity of connectivity for neuron pairs
To quantify the similarity in connectivity of neuron pairs (fig. S1E), we evaluated how likely
our pairs were to be matched by an automated, unsupervised algorithm which aimed to find
the best alignment of the nodes of the left and right hemisphere networks. We performed
multiple graph matchings of the paired left and right hemisphere networks, and measured
how strongly each neuron on the left hemisphere was matched to each possible neuron
on the right hemisphere. To do so, we ran the previously developed FAQ graph-matching
algorithm (31), using K = 20 initializations and a maximum of 30 iterations for each
initialization (see original publication for algorithm details). Note that the annotated pairs
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 23 ---
Winding et al. Page 23
were not used as seeds for this analysis and the initializations were random; thus, these
annotations did not bias the graph matching toward our pairs.
Each run k of the FAQ algorithm yielded a doubly stochastic matrix, (all rows and columns
sum to one) Dk. The element Dk can be thought of as indicating the strength of the match
ij
(for that run, k) from the left hemisphere neuron i to the right hemisphere neuron j. Letting
s be the FAQ objective function value at the end of optimization for run k, and
k
K
S= ∑ sk
k=1
be the sum of these objective function values, we took the weighted average of solutions:
1 k
D=
S
∑ skD
k=1
to find a final doubly stochastic matrix for ranking, D.
Then, we assessed how well bilateral pairs were matched by this assignment matrix D. We
ranked the elements of each row i of D (settling ties using the average) and then found the
rank of that neuron's assigned pair. For instance, if a left neuron's true pair on the right
hemisphere was the neuron it was matched to most strongly, then its neighbor rank was 1;
if it was matched to its true pair less strongly than only one other right hemisphere neuron,
then its neighbor rank was 2, and so on. This provided a metric to evaluate our assigned
neuron pairs, where high ranks for a neuron's pair in the other hemisphere indicated that the
assignment agreed with an unsupervised matching of the two networks.
Network ordering from inputs to outputs
To order the network from sensory neurons to output neurons (fig. S6, F and G), we
applied the “signal flow” algorithm (117, 118). Intuitively, this algorithm seeks to find
a one-dimensional number (the “score”) associated with each neuron, where high values
indicate a neuron is close to the “top” (inputs) of the network, and low values indicate a
neuron is close to the “bottom” (outputs) of the network. To establish this ordering, this
algorithm finds the scores which minimize the sum of edge weights which connect neurons
with very different scores or which connect a low score neuron to a high score neuron
(feedback). Unless otherwise stated, we used the network made up of all edge types when
computing the signal flow score for each neuron. When sorting neuron groups, we sorted
based on the mean signal flow score within each group. In some analyses (Fig. 2G and
fig. S7) we computed signal flow for each edge type network independently. For pairwise
comparisons of these network orderings, we computed the rank correlation (Spearman's ρ)
between the signal flow rankings for each network.
Analyzing edges with multiple connection types Edge reciprocity
Reciprocity is a commonly used metric in network science which quantifies the probability
that two nodes in a directed network are connected through mutual edges in each direction
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 24 ---
Winding et al. Page 24
(119). Specifically, it is defined as the number of reciprocal edges divided by the total
number of edges, where a reciprocal edge means that both A and A are present in
ij ji
the adjacency matrix A. Here, we generalize this notion to multigraphs. With Asource
representing the unweighted, loopless adjacency matrix for the source network, and Atarget
defined likewise for the target network, we define the edge reciprocity r (Asource, Atarget) as r
n
asr(A source ,A target )= 1 ∑AsourceAtarget
∑i n ,jA source i,j ij ji
In other words, averaged over the entire network, this is the conditional probability
of observing a reciprocal edge (Atarget conditioned on observing the forward edge
ij
(Asource)P(Atarget =1∣Asource =1) .
ij ji ij
Probabilities of overlapping connection types
To examine the likelihood of edges with various multiple connection type combinations, we
counted the number of (i, j) pairs with each possible combination of edge type occurrences
in the measured networks (e.g., an axo-dendritic edge with no other type present, axo-
dendritic and axo-axonic but no other edge types) (fig. S6D). To calibrate expectations for
these counts, we used a simple null model of multiplex edge overlaps. This model assumed
that each of the four edge type graphs was generated independently, and modeled each
network as a random (Erdos-Renyi) network. To compute the parameters of this model, we
first simply calculate the global connection probability p for each network A(k) as
k
n
pk= n 1 2 i ∑ ,j Ai ( j k)
Where n is the number of nodes, and A(k) is the unweighted, directed adjacency matrix for
network type k (k = 1,2,3,4 corresponding with AD, AA, DA, DD, respectively). Under the
assumptions above, the expected number of (i, j) pairs which have only axo-dendritic (AD)
edges (denote this m([1, 0, 0, 0])) is m([1, 0, 0, 0]) = n2 p (1 − p)(1 − p)(1 − p)
1 2 3 4
More generally, we denote x to be a 4-dimensional binary vector, which indicates the
presence (1) or absence (0) of the AD, AA, DA, DD edge types, respectively. Then, we can
write the expected number of edges under edge type pattern x as:
4
m(x)=n2∏ pi xi(1−pi) 1−xi
i=1
Under this definition, we calculated the expected number of edges for each combination of
the four edge types and used this to compare with the observed counts.
Studying potential information propagation through signal cascades
We applied a technique for modeling information propagation through a network based
on the independent cascade model, which has been used to study epidemic and social
information transmission (120). Briefly, the algorithm (which we call the signal cascade)
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 25 ---
Winding et al. Page 25
starts with a set of active neurons which propagate their active state to other neurons based
on the number of synapses from active to inactive neurons. Synapse counts can be used to
accurately predict synaptic surface area and are therefore a good proxy for synaptic strength
(61). Note that when investigating downstream partners of neuromodulatory neurons, such
as dopaminergic neurons, we focus on their chemical synapses, which maintain a typical T-
bar structure at the presynapse (13). At each time step, a new set of neurons becomes active,
and previously active neurons enter a deactivated state for the remainder of the experiment.
We modified the original independent cascade model to include a set of “stop” neurons from
which the cascade does not proceed further. This tool allows one to determine how much
signal from a given set of starting neurons could reach other sets of neurons in the brain, and
after how many timesteps (hops). Our approach differs from some previous models of signal
propagation across a connectome in that we only allow activation from neurons which were
active at the last timestep, rather than from neurons which were activated at any previous
timestep (121, 122), allowing us to assess the temporal ordering of the potential flow of
information through the brain.
To elaborate on the details of the model, the algorithm starts with a set of user-defined
nodes which are initially in an active state at time t = 0, and all other nodes in an inactive
state, meaning they are susceptible to activation. We denote the set of active, inactive, and
deactivated nodes at timepoint t as SA,SI, SD, and Sf, respectively. Our modified cascades
t t t
algorithm also includes a set of nodes SE which are “end” nodes from which the cascade
no longer continues—these nodes can become active, but then do not propagate their signal
at the next timepoint. To determine which nodes bcome active at the next timepoint t + 1,
each synapse is assigned an equal probability p of transmission, with p = 0.05. For each
outgoing synapse (i → j) from each active node that is not a stop node (i∈(SA−S E )) to
t
each previously unactivated node (j∈SI) , we conduct an independent Bernoulli trial with
t
probability p to determine whether that synapse activates node j at the next timepoint. Nodes
that had at least one successful activation of an upstream presynapse are included in the set
SA . Every node that was active at time t is moved to the set SD , the deactivated nodes
t+1 t+1
which cannot be activated again during the current cascade. This process was repeated for
T timesteps, where T could vary depending on the particular question of interest. These
cascades were run 1000 times for the same set of start and end nodes ( SA , SE). To
t=0
understand how signals could propagate through the brain based on this model, we tracked
the probability that a node was active at a given time over these 1000 independently run
cascades. Neurons were considered to receive cascade signals when visited in most cascade
iterations. In Fig. 4F, only pathways contributing substantial cascade signal per hop were
considered (>0.1 multihop signal). When analyzing groups of neurons, signal cascade data
were aggregated by averaging these activation probabilities across neurons in a group.
Statistical analysis
Mann Whitney U tests were used in fig. S19, F to I, and fig. S10G. This nonparametric
test was used to avoid assumptions about sample distributions, especially when non-normal
distributions were observed, preventing use of a student's t test.
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 26 ---
Winding et al. Page 26
Morphological similarity calculation within neuron groups
To quantify the similarity between neuron morphologies within clusters (Fig. 3B and fig.
S8, A and B), we applied the NBLAST algorithm (123) as implemented in navis (124),
computing NBLAST scores between all pairs of neurons in the same hemisphere. To make
NBLAST scores symmetric (same score between neurons (i, j) as between (j, i) we set
the NBLAST scores for (i, j) and (j, i) to be the geometric mean of their original scores.
We then apply a normalization scheme to each pairwise NBLAST similarity matrix, in
which scores are converted to their pairwise ranks in the similarity matrix (108). With these
normalized NBLAST scores, we defined a simple score of morphological similarity within
each cluster. First, we computed the mean of all pairwise similarity scores between neurons
in a hemisphere of a specific cluster. Then, we took the mean of those average scores
between left and right hemispheres to compute the final score for a given cluster.
Code
Analyses relied on NumPy (125), SciPy (126), Pandas (127), NetworkX (128), navis (124),
and pythoncatmaid (https://pypi.org/project/python-catmaid/). Plotting was performed using
matplotlib (129), Seaborn (130), and Blender (https://www.blender.org/). UpSet plots were
used to visualize complex intersections (131).
Supplementary Material
Refer to Web version on PubMed Central for supplementary material.
Acknowledgements
The authors thank HHMI Janelia Research Campus for funding and support, the Janelia Fly EM Project Team for
imaging the EM volume, and the Janelia Visiting Scientist Program for outstanding support over the years. We
thank E. C. Croteau-Chonka for providing the base image for the larva illustrations. The neuronal and synaptic
reconstruction presented in this paper was made possible through the collaborative efforts of 86 individuals. We
would like to acknowledge the work of all those who contributed to the reconstruction of the larval brain, either
directly for this paper or through past publications: A. Fushiki, I.A., M.W., A.K., J.V.A., F.L., P. Schlegel, A.C., I.
Larderet, K. Eichler, V.H., A. Miroschnikow, T. Saumweber, J. Lovick, M. Berck, C. Schneider-Mizell, N. Riebli,
L. Maier, A. S. Bates, L. Herren, I. Brueckmann, B. Afonso, A. S. Thum, L. Claus, H. Lacin, A. MacLachlan,
S. Hückesfeld, A. Schoofs, S. Sprecher, A. A. Zarin, H. Chen, E.B., A.C., J. Tran, C. Q. Doe, N.R., S. Takagi,
L. Masuda-Nakagawa, C. Barnes, M. Zwart, N. Imambocus, E. Hasegawa, C. Wreden, A. Stoychev, X. Tang, A.
Samuel, A. Burgos, J. Jonaitis, K. Turner, A. Hiramoto, T. Ohyama, S. Wilson, S. Qian, J. Truman, H. Kohsaka, J.
Meng, B. Kemp, Q. Zhao, E. Heckscher, W. Osman, D. Bock, J. Macleod, A. Champion, T. Jovanic, R. Arruda, E.
Imura, B. Mark, M. Klein, L. Lungu, M. Corrales, C. Julliot de La Morandière, T. Guillorit, M. Louis, S. Gerhard,
A. Patel, L. Guo, Y. He, K. Karkali, J. Picao Osorio, M. Lehman, T.K., T. To, A. Nose, E. O'Garro-Priddie, A.
Ferreira Castro, B. El Galfi.
Funding
This work was supported by the following: Howard Hughes Medical Institute Janelia Research Campus (to M.Z.,
A.C., M.W., A.F., N.R., and I.V.A.); Howard Hughes Medical Institute Visiting Scientist Program (to A.V.);
Wellcome Trust grant 205038/Z/16/Z (to A.C.); Wellcome Trust grant 205050/Z/16/Z (to M.Z. and M.W.); ERC
grant ERC-2018-COG: 819650 (to M.Z.); MRC LMB Core Funding (to A.C. and M.Z.); NSF GRFP grant
DGE1746891 (to B.D.P.); NSF CAREER Award 1942963 (to J.T.V.); NIH BRAIN Initiative RF1MH123233 (to
J.T.V. and C.E.P.); DARPA D3M contract FA8750-17-2-0112 (to H.G.P., Y.P., and C.E.P.); Air Force Research
Laboratory contract FA8750-18-2-0035 (to H.G.P., Y.P., and C.E.P.); DARPA contract FA8750-20-2-1001 (to
H.G.P., Y.P., and C.E.P.); NIH Grant 2 R01 NS054814 (to I.V.A. and V.H.); and NSF NeuroNex grant 2014862
(to J.T.V.). The US Government is authorized to reproduce and distribute reprints for Governmental purposes
notwithstanding any copyright notation thereon. The views and conclusions contained herein are those of the
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 27 ---
Winding et al. Page 27
authors and should not be interpreted as necessarily representing the official policies or endorsements, either
expressed or implied, of the Air Force Research Laboratory and DARPA or the U.S. Government.
Data and materials availability
All data are available in the manuscript or the supplementary materials. Raw EM data
and neuron reconstructions are publicly available through the CATMAID interface at https://
catmaid.virtualflybrain.org/ (L1 Larval CNS). All code is deposited at Zenodo (132–134).
References and Notes
1. Denk W, Briggman KL, Helmstaedter M. Structural neurobiology: Missing link to a mechanistic
understanding of neural computation. Nat Rev Neurosci. 2012; 13: 351–358. DOI: 10.1038/nrn3169
[PubMed: 22353782]
2. Bargmann CI, Marder E. From the connectome to brain function. Nat Methods. 2013; 10: 483–490.
DOI: 10.1038/nmeth.2451 [PubMed: 23866325]
3. White JG, Southgate E, Thomson JN, Brenner S. The structure of the nervous system of
the nematode Caenorhabditis elegans. Philos Trans R Soc B. 1986; 314: 1–340. DOI: 10.1098/
rstb.1986.0056 [PubMed: 22462104]
4. Ryan K, Lu Z, Meinertzhagen IA. The CNS connectome of a tadpole larva of Ciona intestinalis
(L.) highlights sidedness in the brain of a chordate sibling. eLife. 2016; 5: 353–356. DOI: 10.7554/
eLife.16962 [PubMed: 27921996]
5. Verasztó C, et al. bioRxiv. 2020; 2020.08.21.260984 doi: 10.1101/2020.08.21.260984
6. Kornfeld J, Denk W. Progress and remaining challenges in high-throughput volume electron
microscopy. Curr Opin Neurobiol. 2018; 50: 261–267. DOI: 10.1016/j.conb.2018.04.030 [PubMed:
29758457]
7. Wanner AA, Friedrich RW. Whitening of odor representations by the wiring diagram of the
olfactory bulb. Nat Neurosci. 2020; 23: 433–442. DOI: 10.1038/s41593-019-0576-z [PubMed:
31959937]
8. Bock DD, et al. Network anatomy and in vivo physiology of visual cortical neurons. Nature. 2011;
471: 177–182. DOI: 10.1038/nature09802 [PubMed: 21390124]
9. Huang L, et al. BRICseq Bridges Brain-wide Interregional Connectivity to Neural Activity
and Gene Expression in Single Animals. Cell. 2020; 183: 2040. doi: 10.1016/j.cell.2020.12.009
[PubMed: 33357401]
10. Van Essen DC, Anderson CH, Felleman DJ. Information processing in the primate visual system:
An integrated systems perspective. Science. 1992; 255: 419–423. DOI: 10.1126/science.1734518
[PubMed: 1734518]
11. Lemon, Wc; , et al. Whole-central nervous system functional imaging in larval Drosophila. Nat
Commun. 2015; 6 doi: 10.1126/science.1734518 [PubMed: 1734518]
12. Ahrens MB, Orger MB, Robson DN, Li JM, Keller PJ. Whole-brain functional imaging at
cellular resolution using light-sheet microscopy. Nat Methods. 2013; 10: 413–420. DOI: 10.1038/
nmeth.2434 [PubMed: 23524393]
13. Eichler K, et al. The complete connectome of a learning and memory centre in an insect brain.
Nature. 2017; 548: 175–182. DOI: 10.1038/nmeth.2434 [PubMed: 28796202]
14. Truman JW, Price J, Miyares RL, Lee T. bioRxiv. 2022; 2022.06.09.495452 doi:
10.1101/2022.06.09.495452
15. Carreira-Rosario A, et al. MDN brain descending neurons coordinately activate backward and
inhibit forward locomotion. Elife. 2018; 7 doi: 10.1038/nature23455 [PubMed: 28796202]
16. Almeida-Carvalho MJ, et al. The Ol1mpiad: Concordance of behavioural faculties of stage 1 and
stage 3 Drosophila larvae. J Exp Biol. 2017; 220: 2452–2475. DOI: 10.1242/jeb.156646 [PubMed:
28679796]
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 28 ---
Winding et al. Page 28
17. Pauls D, Selcho M, Gendre N, Stocker RF, Thum AS. Drosophila larvae establish appetitive
olfactory memories via mushroom body neurons of embryonic origin. J Neurosci. 2010; 30:
10655–10666. DOI: 10.1523/JNEUROSCI.1281-10.2010 [PubMed: 20702697]
18. Gerber B, Stocker RF. The Drosophila larva as a model for studying chemosensation and
chemosensory learning: A review. Chem Senses. 2007; 32: 65–89. DOI: 10.1093/chemse/bjl030
[PubMed: 17071942]
19. Eschbach C, et al. Recurrent architecture for adaptive regulation of learning in the insect brain. Nat
Neurosci. 2020; 23: 544–555. DOI: 10.1038/s41593-020-0607-9 [PubMed: 32203499]
20. Lesar A, Tahir J, Wolk J, Gershow M. Switch-like and persistent memory formation in individual
Drosophila larvae. eLife. 2021; 10 e70317 doi: 10.7554/eLife.70317 [PubMed: 34636720]
21. Eschbach C, et al. Circuits for integrating learned and innate valences in the insect brain. eLife.
2021; 10 e62567 doi: 10.7554/eLife.62567 [PubMed: 34755599]
22. Jovanic T, et al. Competitive Disinhibition Mediates Behavioral Choice and Sequences in
Drosophila. Cell. 2016; 167: 858–870. e19 doi: 10.1016/j.cell.2016.09.009 [PubMed: 27720450]
23. Ohyama T, et al. A multilevel multimodal circuit enhances action selection in Drosophila. Nature.
2015; 520: 633–639. DOI: 10.1038/nature14297 [PubMed: 25896325]
24. Gerhard S, Andrade I, Fetter RD, Cardona A, Schneider-Mizell CM. Conserved neural circuit
structure across Drosophila larval development revealed by comparative connectomics. eLife.
2017; 6 e29089 doi: 10.7554/eLife.29089 [PubMed: 29058674]
25. Li H-H, et al. A GAL4 driver resource for developmental and behavioral studies on the larval
CNS of Drosophila. Cell Rep. 2014; 8: 897–908. DOI: 10.1016/j.celrep.2014.06.065 [PubMed:
25088417]
26. Karagyozov D, Mihovilovic Skanata M, Lesar A, Gershow M. Recording Neural Activity in
Unrestrained Animals with Three-Dimensional Tracking Two-Photon Microscopy. Cell Rep. 2018;
25: 1371–1383. e10 doi: 10.1016/j.celrep.2018.10.013 [PubMed: 30380425]
27. Valdes-Aleman J, et al. Comparative Connectomics Reveals How Partner Identity, Location, and
Activity Specify Synaptic Connectivity in Drosophila. Neuron. 2021; 109: 105–122. e7 doi:
10.1016/j.neuron.2020.10.004 [PubMed: 33120017]
28. Schneider-Mizell CM, et al. Quantitative neuroanatomy for connectomics in Drosophila. eLife.
2016; 5 e12059 doi: 10.7554/eLife.12059 [PubMed: 26990779]
29. Patsolic HG, Park Y, Lyzinski V, Priebe CE. Vertex nomination via seeded graph matching. Stat
Anal Data Min. 13: 2020; 229–244. DOI: 10.1002/sam.11454
30. Fishkind DE, et al. Seeded graph matching. Pattern Recognit. 87: 2019; 203–215. DOI: 10.1016/
j.patcog.2018.09.014
31. Vogelstein JT, et al. Fast approximate quadratic programming for graph matching. PLOS ONE.
2015; 10 e0121002 doi: 10.1371/journal.pone.0121002 [PubMed: 25886624]
32. Scheffer LK, et al. A connectome and analysis of the adult Drosophila central brain. eLife. 2020; 9
e57443 doi: 10.7554/eLife.57443 [PubMed: 32880371]
33. Berck ME, et al. The wiring diagram of a glomerular olfactory system. eLife. 2016; 5 e14859 doi:
10.7554/eLife.14859 [PubMed: 27177418]
34. Larde I, et al. Organization of the drosophila larval visual circuit. eLife. 2017; 6 doi: 10.7554/
eLife.14859 [PubMed: 27177418]
35. Miroschnikow A, et al. Convergence of monosynaptic and polysynaptic sensory paths onto
common motor outputs in a Drosophila feeding connectome. eLife. 2018; 7 e40247 doi: 10.7554/
eLife.40247 [PubMed: 30526854]
36. Schlegel P, et al. Synaptic transmission parallels neuromodulation in a central food-intake circuit.
eLife. 2016; 5 e16799 doi: 10.7554/eLife.16799 [PubMed: 27845623]
37. Fushiki A, et al. A circuit mechanism for the propagation of waves of muscle contraction in
Drosophila. eLife. 2016; 5 e13253 doi: 10.7554/eLife.13253 [PubMed: 26880545]
38. Burgos A, et al. Nociceptive interneurons control modular motor pathways to promote escape
behavior in Drosophila. eLife. 2018; 7 e26016 doi: 10.7554/eLife.26016 [PubMed: 29528286]
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 29 ---
Winding et al. Page 29
39. Melcher C, Pankratz MJ. Candidate gustatory interneurons modulating feeding behavior in
the Drosophila brain. PLOS Biol. 2005; 3 e305 doi: 10.1371/journal.pbio.0030305 [PubMed:
16122349]
40. Andrade IV, et al. Developmentally Arrested Precursors of Pontine Neurons Establish an
Embryonic Blueprint of the Drosophila Central Complex. Curr Biol. 2019; 29: 412–425. e3 doi:
10.1016/j.cub.2018.12.012 [PubMed: 30661802]
41. Cervantes-Sandoval I, Phan A, Chakraborty M, Davis RL. Reciprocal synapses between mushroom
body and dopamine neurons form a positive feedback loop required for learning. eLife. 2017; 6
e23789 doi: 10.7554/eLife.23789 [PubMed: 28489528]
42. Bates AS, et al. Complete Connectomic Reconstruction of Olfactory Projection Neurons in the Fly
Brain. Curr Biol. 2020; 30: 3183–3199. e6 doi: 10.1016/j.cub.2020.06.042 [PubMed: 32619485]
43. Schneider-Mizell CM, et al. eLife. 2021; 10 e73783 doi: 10.1016/j.cub.2020.06.042 [PubMed:
34851292]
44. Cover KK, Mathur BN. Axo-axonic synapses: Diversity in neural circuit function. J Comp Neurol.
2021; 529: 2391–2401. DOI: 10.1002/cne.25087 [PubMed: 33314077]
45. Gobell S. Dendroaxonic synapses in the substantia gelatinosa glomeruli of the spinal trigeminal
nucleus of the cat J Comp. Neurol. 1976; 167: 165–176. DOI: 10.1002/cne.901670204 [PubMed:
932238]
46. Jahr CE, Nicoll RA. Dendrodendritic inhibition: Demonstration with intracellular recording.
Science. 1980; 207: 1473–1475. DOI: 10.1126/science.7361098 [PubMed: 7361098]
47. Morgan JL, Lichtman JW. An Individual Interneuron Participates in Many Kinds of Inhibition and
Innervates Much of the Mouse Visual Thalamus. Neuron. 2020; 106: 468–481. e2 doi: 10.1016/
j.neuron.2020.02.001 [PubMed: 32142646]
48. Witvliet D, et al. Connectomes across development reveal principles of brain maturation. Nature.
2021; 596: 257–261. DOI: 10.1038/s41586-021-03778-8 [PubMed: 34349261]
49. Wilson RI. Neural and behavioral mechanisms of olfactory perception. Curr Opin Neurobiol. 2008;
18: 408–412. DOI: 10.1016/j.conb.2008.08.015 [PubMed: 18809492]
50. Silver RA. Neuronal arithmetic. Nat Rev Neurosci. 2010; 11: 474–489. DOI: 10.1038/nrn2864
[PubMed: 20531421]
51. Towlson EK, Vértes PE, Ahnert SE, Schafer WR, Bullmore ET. The rich club of
the C. elegans neuronal connectome. J Neurosci. 2013; 33: 6380–6387. DOI: 10.1523/
JNEUROSCI.3784-12.2013 [PubMed: 23575836]
52. Aso Y, et al. Mushroom body output neurons encode valence and guide memory-based action
selection in Drosophila. eLife. 2014; 3 e04580 doi: 10.7554/eLife.04580 [PubMed: 25535794]
53. Hulse BK, et al. A connectome of the Drosophila central complex reveals network motifs
suitable for flexible navigation and context-dependent action selection. eLife. 2021; 10 e66039
doi: 10.7554/eLife.66039 [PubMed: 34696823]
54. Hernandez-Nunez L, et al. Synchronous and opponent thermosensors use flexible cross-inhibition
to orchestrate thermal homeostasis. Sci Adv. 2021; 7 eabg6707 doi: 10.1126/sciadv.abg6707
[PubMed: 34452914]
55. Qian CS, Kaplow M, Lee JK, Grueber WB. Diversity of Internal Sensory Neuron Axon Projection
Patterns Is Controlled by the POU-Domain Protein Pdm3 in Drosophila Larvae. J Neurosci. 2018;
38: 2081–2093. DOI: 10.1523/JNEUROSCI.2125-17.2018 [PubMed: 29367405]
56. Imambocus BN, et al. A neuropeptidergic circuit gates selective escape behavior of Drosophila
larvae. Curr Biol. 2022; 32: 149–163. e8 doi: 10.1016/j.cub.2021.10.069 [PubMed: 34798050]
57. Kandel, ER, Schwartz, JH, Jessell, TM, Siegelbaum, SA, Hudspeth, AJ. Principles of Neural
Science. Fifth Edition. McGraw Hill Professional; 2013.
58. Riesenhuber M, Poggio T. Are cortical models really bound by the “binding problem”. Neuron.
1999; 24: 87–93. DOI: 10.1016/S0896-6273(00)80824-7 [PubMed: 10677029]
59. Kaas JH, Hackett TA. ‘What’ and ‘where’ processing in auditory cortex. Nat Neurosci. 1999; 2:
1045–1047. DOI: 10.1038/15967 [PubMed: 10570476]
60. Pujala A, Koyama M. Chronology-based architecture of descending circuits that underlie the
development of locomotor repertoire after birth. eLife. 2019; 8 e42135 doi: 10.7554/eLife.42135
[PubMed: 30801247]
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 30 ---
Winding et al. Page 30
61. Barnes CL, Bonnéry D, Cardona A. Synaptic counts approximate synaptic contact area in
Drosophila. PLOS ONE. 2022; 17 e0266064 doi: 10.1371/journal.pone.0266064 [PubMed:
35377898]
62. Barron AB, Sovik E, Cornish JL. The roles of dopamine and related compounds in reward-seeking
behavior across animal phyla. Front Behav Neurosci. 2010; 4: 163. doi: 10.3389/fnbeh.2010.00163
[PubMed: 21048897]
63. Cognigni P, Felsenberg J, Waddell S. Do the right thing: Neural network mechanisms of memory
formation, expression and update in Drosophila. Curr Opin Neurobiol. 2018; 49: 51–58. DOI:
10.1016/j.conb.2017.12.002 [PubMed: 29258011]
64. Pulver SR, et al. Imaging fictive locomotor patterns in larval Drosophila. J Neurophysiol. 2015;
114: 2564–2577. DOI: 10.1152/jn.00731.2015 [PubMed: 26311188]
65. Kar K, Kubilius J, Schmidt K, Issa EB, DiCarlo JJ. Evidence that recurrent circuits are critical
to the ventral stream's execution of core object recognition behavior. Nat Neurosci. 2019; 22:
974–983. DOI: 10.1038/s41593-019-0392-5 [PubMed: 31036945]
66. Liao Q, Poggio T. Bridging the Gaps Between Residual Learning, Recurrent Neural Networks and
Visual Cortex. arXiv:1604.03640. 2016.
67. Ohyama T, et al. PLOS ONE. 2013; 8 e71706 doi: 10.1371/journal.pone.0071706 [PubMed:
23977118]
68. Kohsaka H, Takasu E, Morimoto T, Nose A. A group of segmental premotor interneurons regulates
the speed of axial locomotion in Drosophila larvae. Curr Biol. 2014; 24: 2632–2642. DOI:
10.1016/j.cub.2014.09.026 [PubMed: 25438948]
69. Lahiri S, et al. Two alternating motor programs drive navigation in Drosophila larva. PLOS ONE.
2011; 6 e23180 doi: 10.1371/journal.pone.0023180 [PubMed: 21858019]
70. Zwart MF, et al. Selective Inhibition Mediates the Sequential Recruitment of Motor Pools. Neuron.
2016; 91: 615–628. DOI: 10.1016/j.neuron.2016.06.031 [PubMed: 27427461]
71. Zarin AA, Mark B, Cardona A, Litwin-Kumar A, Doe CQ. A multilayer circuit architecture for
the generation of distinct locomotor behaviors in Drosophila. eLife. 2019; 8 e51781 doi: 10.7554/
eLife.51781 [PubMed: 31868582]
72. Eschbach C, Zlatic M. Useful road maps: Studying Drosophila larva's central nervous
system with the help ofconnectomics. Curr Opin Neurobiol. 2020; 65: 129–137. DOI: 10.1016/
j.conb.2020.09.008 [PubMed: 33242722]
73. Heckscher ES, et al. Even-Skipped(+) Interneurons Are Core Components of a Sensorimotor
Circuit that Maintains Left-Right Symmetric Muscle Contraction Amplitude. Neuron. 2015; 88:
314–329. DOI: 10.1016/j.neuron.2015.09.009 [PubMed: 26439528]
74. Tastekin I, et al. Sensorimotor pathway controlling stopping behavior during chemotaxis in
the Drosophila melanogaster larva. eLife. 2018; 7 e38740 doi: 10.7554/eLife.38740 [PubMed:
30465650]
75. Masson J-B, et al. Identifying neural substrates of competitive interactions and sequence transitions
during mechanosensory responses in Drosophila. PLOS Genet. 2020; 16 e1008589 doi: 10.1371/
journal.pgen.1008589 [PubMed: 32059010]
76. Vogelstein JT, et al. Discovery of brainwide neural-behavioral maps via multiscale unsupervised
structure learning. Science. 2014; 344: 386–392. DOI: 10.1126/science.1250298 [PubMed:
24674869]
77. Jenett A, et al. A GAL4-driver line resource for Drosophila neurobiology. Cell Rep. 2012; 2:
991–1001. DOI: 10.1016/j.celrep.2012.09.011 [PubMed: 23063364]
78. Corrales M, et al. A single-cell transcriptomic atlas of complete insect nervous systems across
multiple life stages. Neural Dev. 2022; 17: 8. doi: 10.1186/s13064-022-00164-6 [PubMed:
36002881]
79. Bates AS, Janssens J, Jefferis GSXE, Aerts S. Neuronal cell types in the fly: Single-cell
anatomy meets single-cell genomics. Curr Opin Neurobiol. 2019; 56: 125–134. DOI: 10.1016/
j.conb.2018.12.012 [PubMed: 30703584]
80. MICrONS Consortium. et al. bioRxiv. 2021; 2021.07.28.454025 doi: 10.1101/2021.07.28.454025
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 31 ---
Winding et al. Page 31
81. Hige T, Aso Y, Modi MN, Rubin GM, Turner GC. Heterosynaptic Plasticity Underlies
Aversive Olfactory Learning in Drosophila. Neuron. 2015; 88: 985–998. DOI: 10.1016/
j.neuron.2015.11.003 [PubMed: 26637800]
82. Manoim JE, Davidson AM, Weiss S, Hige T, Parnas M. Lateral axonal modulation is required for
stimulus-specific olfactory conditioning in Drosophila. Curr Biol. 2022; 32: 4438–4450. e5 doi:
10.1016/j.cub.2022.09.007 [PubMed: 36130601]
83. Soiza-Reilly M, Anderson WB, Vaughan CW, Commons KG. Presynaptic gating of excitation in
the dorsal raphe nucleus by GABA. Proc Natl Acad Sci USA. 2013; 110: 15800–15805. DOI:
10.1073/pnas.1304505110 [PubMed: 24019494]
84. Fusi S, Miller EK, Rigotti M. Why neurons mix: High dimensionality for higher cognition. Curr
Opin Neurobiol. 2016; 37: 66–74. DOI: 10.1016/j.conb.2016.01.010 [PubMed: 26851755]
85. He, K; , et al. 2016 IEEE Conference on Computer Vision and Pattern Recognition; 2016. 770–
778.
86. Ronneberger O, Fischer P, Brox T. U-Net: Convolutional Networks for Biomedical Image
Segmentation. arXiv:1505.04597. 2015; doi: 10.1007/978-3-319-24574-4_28
87. Simonyan K, Zisserman A. Very Deep Convolutional Networks for Large-Scale Image
Recognition. arXiv:1409.1556. 2014.
88. Srivastava RK, Greff K, Schmidhuber J. Highway Networks. arXiv:1505.00387. 2015.
89. Gilbert CD, Li W. Top-down influences on visual processing. Nat Rev Neurosci. 2013; 14: 350–
363. DOI: 10.1038/nrn3476 [PubMed: 23595013]
90. Spoerer CJ, Kietzmann TC, Mehrer J, Charest I, Kriegeskorte N. Recurrent neural networks
can explain flexible trading of speed and accuracy in biological vision. PLOS Comput Biol. 16
e1008215 2020; doi: 10.1371/journal.pcbi.1008215 [PubMed: 33006992]
91. Bahl A, Engert F. Neural circuits for evidence accumulation and decision making in
larval zebrafish. Nat Neurosci. 2020; 23: 94–102. DOI: 10.1038/s41593-019-0534-9 [PubMed:
31792464]
92. Singer W. Recurrent dynamics in the cerebral cortex: Integration of sensory evidence with stored
knowledge. Proc Natl Acad Sci USA. 2021; 118 e2101043118 doi: 10.1073/pnas.2101043118
[PubMed: 34362837]
93. van Bergen RS, Kriegeskorte N. Going in circles is the way forward: The role of recurrence
in visual inference. Curr Opin Neurobiol. 2020; 65: 176–193. DOI: 10.1016/j.conb.2020.11.009
[PubMed: 33279795]
94. Beaulieu J-M, Gainetdinov RR. The physiology, signaling, and pharmacology of dopamine
receptors. Pharmacol Rev. 2011; 63: 182–217. DOI: 10.1124/pr.110.002642 [PubMed: 21303898]
95. Raman DV, O'Leary T. Frozen algorithms: How the brain's wiring facilitates learning. Curr Opin
Neurobiol. 2021; 67: 207–214. DOI: 10.1016/j.conb.2020.12.017 [PubMed: 33508698]
96. Druckmann S, Chklovskii DB. Neuronal circuits underlying persistent representations despite
time varying activity. Curr Biol. 2012; 22: 2095–2103. DOI: 10.1016/j.cub.2012.08.058 [PubMed:
23084992]
97. Daie K, Svoboda K, Druckmann S. Targeted photostimulation uncovers circuit motifs supporting
short-term memory. Nat Neurosci. 2021; 24: 259–265. DOI: 10.1038/s41593-020-00776-3
[PubMed: 33495637]
98. Lyutova R, et al. Reward signaling in a recurrent circuit of dopaminergic neurons and peptidergic
Kenyon cells. Nat Commun. 2019; 10: 3097. doi: 10.1038/s41467-019-11092-1 [PubMed:
31308381]
99. Zolin A, et al. Context-dependent representations of movement in Drosophila dopaminergic
reinforcement pathways. Nat Neurosci. 2021; 24: 1555–1566. DOI: 10.1038/s41593-021-00929-y
[PubMed: 34697455]
100. van den Heuvel MP, Sporns O. Rich-club organization of the human connectome. J Neurosci.
2011; 31: 15775–15786. DOI: 10.1523/JNEUROSCI.3539-11.2011 [PubMed: 22049421]
101. Omamiuda-Ishikawa N, Sakai M, Emoto K. A pair of ascending neurons in the subesophageal
zone mediates aversive sensory inputs-evoked backward locomotion in Drosophila larvae. PLOS
Genet. 2020; 16 e1009120 doi: 10.1371/journal.pgen.1009120 [PubMed: 33137117]
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 32 ---
Winding et al. Page 32
102. Drew T, Cabana T, Rossignol S. Responses of medullary reticulospinal neurones to stimulation
of cutaneous limb nerves during locomotion in intact cats. Exp Brain Res. 1996; 111: 153–168.
DOI: 10.1007/BF00227294 [PubMed: 8891647]
103. Chang YT, Lin JW, Faber DS. Spinal inputs to the ventral dendrite of the teleost Mauthner cell.
Brain Res. 1987; 417: 205–213. DOI: 10.1016/0006-8993(87)90444-6 [PubMed: 3651811]
104. Hückesfeld S, et al. Unveiling the sensory and interneuronal pathways of the neuroendocrine
connectome in Drosophila. eLife. 2021; 65745 doi: 10.7554/eLife.65745 [PubMed: 34085637]
105. Hartenstein V, et al. Lineage-associated tracts defining the anatomy of the Drosophila first
instar larval brain. Dev Biol. 2015; 406: 14–39. DOI: 10.1016/j.ydbio.2015.06.021 [PubMed:
26141956]
106. Chung J, et al. Statistical Connectomics. Annu Rev Stat Appl. 2021; 8: 463–492. DOI: 10.1146/
annurev-statistics-042720-023234
107. Athreya A, et al. Statistical inference on random dot product graphs: A survey. J Mach Learn Res.
2017; 18: 8393–8484.
108. Chung J, et al. JMLR. 2019; 20: 1–7.
109. Agterberg J, Tang M, Priebe C. Nonparametric Two-Sample Hypothesis Testing for Random
Graphs with Negative and Repeated Eigenvalues. arXiv:2012.09828. 2020.
110. Lyzinski V, Tang M, Athreya A, Park Y, Priebe CE. Community Detection and Classification in
Hierarchical Stochastic Blockmodels. IEEE Trans Netw Sci Eng. 2017; 4: 13–26. DOI: 10.1109/
TNSE.2016.2634322
111. Li T, et al. Hierarchical Community Detection by Recursive Partitioning. J Am Stat Assoc. 2022;
117: 951–968. DOI: 10.1080/01621459.2020.1833888
112. Sussman DL, Tang M, Fishkind DE, Priebe CE. A Consistent Adjacency Spectral Embedding
for Stochastic Blockmodel Graphs. J Am Stat Assoc. 2012; 107: 1119–1128. DOI:
10.1080/01621459.2012.699795
113. Athey TL, Liu T, Pedigo BD, Vogelstein JT. AutoGMM: Automatic and Hierarchical Gaussian
Mixture Modeling in Python. arXiv:1909.02688. 2019.
114. Pedregosa F, et al. Scikit-learn: Machine learning in Python. JMLR. 2011; 12: 2825–2830. DOI:
10.1080/01621459.2020.1833888
115. Schwarz G. Estimating the Dimension of a Model. Ann Stat. 1978; 6: 461–464. DOI:
10.1214/aos/1176344136
116. Fraley, C; Raftery, AE. MCLUST: Software for model-based cluster and discriminant analysis.
Department of Statistics, University of Washington: Technical Report. 1998. http://132.180.15.2/
math/statlib/S/mclust/old/mclust.pdf
117. Carmel L, Harel D, Koren Y. Combining hierarchy and energy for drawing directed graphs.
IEEE Trans Vis Comput Graph. 2004; 10: 46–57. DOI: 10.1109/TVCG.2004.1260757 [PubMed:
15382697]
118. Varshney LR, Chen BL, Paniagua E, Hall DH, Chklovskii DB. Structural properties of the
Caenorhabditis elegans neuronal network. PLOS Comput Biol. 2011; 7 e1001066 doi: 10.1371/
journal.pcbi.1001066 [PubMed: 21304930]
119. Newman, MEJ. Networks. Oxford Univ Press; 2018.
120. Goldenberg J, Libai B, Muller E. Talk of the Network: A Complex Systems Look at
the Underlying Process of Word-of-Mouth. Mark Lett. 2001; 12: 211–223. DOI: 10.1023/
A:1011122126881
121. Misic B, et al. Cooperative and Competitive Spreading Dynamics on the Human Connectome.
Neuron. 2015; 86: 1518–1529. DOI: 10.1016/j.neuron.2015.05.035 [PubMed: 26087168]
122. Schlegel P, et al. Information flow, cell types and stereotypy in a full olfactory connectome. eLife.
2021; 66018 doi: 10.7554/eLife.66018 [PubMed: 34032214]
123. Costa M, Manton JD, Ostrovsky AD, Prohaska S, Jefferis GSXE. NBLAST: Rapid, Sensitive
Comparison of Neuronal Structure and Construction of Neuron Family Databases. Neuron. 2016;
91: 293–311. DOI: 10.1016/j.neuron.2016.06.012 [PubMed: 27373836]
124. Schlegel P, Barnes C, Jagannathan S, Pedigo B. schlegelp/navis: Version 0.6.0, Zenodo. 2021.
https://zenodo.org/record/4751181/export/hx
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 33 ---
Winding et al. Page 33
125. Harris CR, et al. Array programming with NumPy. Nature. 2020; 585: 357–362. DOI: 10.1038/
s41586-020-2649-2 [PubMed: 32939066]
126. Virtanen P, et al. SciPy 1.0: Fundamental algorithms for scientific computing in Python. Nat
Methods. 2020; 17: 261–272. DOI: 10.1038/s41592-019-0686-2 [PubMed: 32015543]
127. McKinney, W. Proceedings of the 9th Python in Science Conference; 2010. 51–56. SciPy
128. Hagberg A, Swart P, Chult DS. Exploring network structure, dynamics, and function using
NetworkX. 2008. USDOEhttps://www.osti.gov/biblio/960616
129. Hunter JD. Matplotlib: A 2D Graphics Environment. IEEE. 2007; 9: 90–95. DOI: 10.21105/
joss.03021
130. Waskom M. seaborn: Statistical data visualization. J Open Source Softw. 2021; 6: 3021. doi:
10.21105/joss.03021
131. Lex A, Gehlenborg N, Strobelt H, Vuillemot R, Pfister H. UpSet: Visualization of Intersecting
Sets. IEEE Trans Vis Comput Graph. 2014; 20: 1983–1992. DOI: 10.1109/TVCG.2014.2346248
[PubMed: 26356912]
132. Winding M. mwinding/connectome_tools: Archived Repo for Publication, Version v1.0. Zenodo.
2022; doi: 10.5281/zenodo.7473710
133. Winding M. mwinding/connectome_analysis: Archived Repo for Publication, Version v1.0.
Zenodo. 2022; doi: 10.5281/zenodo.7473718
134. Pedigo B. neurodata/maggot_models: pre-resubmission-v1, Version pre-resubmission-v1.
Zenodo. 2022; doi: 10.5281/zenodo.7474133
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 34 ---
Winding et al. Page 34
Fig. 1. Comprehensive reconstruction of a Drosophila larva brain.
(A) Morphology of differentiated brain neurons in the CNS of a Drosophila larva. (B)
Most (>99%) of neurons were reconstructed to completion, defined by reconstruction of
all terminal branches (see Methods) and no data quality issues preventing identification of
axons and dendrites. Pre- and postsynaptic sites were considered complete when connected
to a brain neuron or ascending arbors from neurons outside the brain. (C) Left and right
homologous neuron pairs were identified using an automated graph matching with manual
proofreading. There was no clear partner for 14 neurons based on this workflow (unpaired),
along with 176 unpaired KCs in the learning and memory center. (D and E) Schematic
overview of brain structure. Brain inputs include SNs, which directly synapse onto brain
neurons, and ANs from VNC segment A1, which receive direct or polysynaptic input from
A1 sensories (see fig. S2). Brain interneurons transmit these input signals to output neurons:
DNs to the subesophageal zone (SEZ) (DNSEZ), DNs to the VNC (DNVNC), and ring gland
neurons (RGN). (F to H) Cell classes in the brain. Some interneurons belong to multiple
classes, but are displayed as mutually exclusive for plotting expedience (see fig. S4). Note
that some previously reconstructed interneurons (40 total) and output neurons (6 total) are
included in the barplots but are not brain neurons per se and not included in counts. There
were 20 brain output neurons with known cell classes that were therefore also included in
(G).
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 35 ---
Winding et al. Page 35
Fig. 2. Identification of all brain axons and dendrites revealed four connection types.
(A) Axons and dendrites were identified in all brain neurons, >95% of which contained fully
differentiated axons and dendrites. The remainder were unpolarized neurons and immature
neurons. (B) Axons contained mostly presynaptic sites (orange), whereas dendrites
contained mostly postsynaptic sites (blue), but pre- and postsynaptic sites were observed
in both compartments. (C) Synaptic connections between brain neurons were categorized
as axo-dendritic (a-d), axo-axonic (a-a), dendro-dendritic (d-d), or dendro-axonic (d-a).
(D) Adjacency matrices displaying all connection types between brain neurons (raw data
in data S1 and S2). Each quadrant represents a different connectivity type between each
presynaptic neuron (row) and postsynaptic neuron (column) in the brain. (E) Graph metrics
for subgraphs comprising each connection type: number of nodes participating in each
connection type, graph density (number of connections observed divided by all possible
connections), and max degree (maximum number of connections from a single neuron). (F)
Fraction of feedforward and feedback synapses per connection type, defined based on the
overall neuron sorting from sensory to output (fig. S6, F and G). (G) Comparison of the
direction of information flow for the indicated connection types. Individual neurons in each
graph type were sorted using the signal flow algorithm (see Methods) and the correlation
between these node sortings was quantified. a-d sorting best matched the summed graph
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 36 ---
Winding et al. Page 36
sorting (all edge types together). The d-a sorting was negatively correlated with a-d (–0.59).
(H) Edge reciprocity between different edge types, i.e., fraction of forward edges that were
coincident with different backward edge types.
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 37 ---
Winding et al. Page 37
Fig. 3. Hierarchical clustering and analysis of brain structure.
(A) Hierarchical clustering of neurons using a joint left-right hemisphere spectral embedding
based on connectivity. Clusters were colored based on cell classes (Fig. 1G and fig. S4),
but this information was not used for clustering. Clusters were sorted using signal flow.
(B) Example clusters with intracluster morphological similarity score using NBLAST (see
Methods). (C) Adjacency matrix of the brain sorted by hierarchical cluster structure. (D)
Network diagram of level 4 clusters displays coarse brain structure. Colored pie charts
display cell types within clusters. (E) Fraction of a-d hub neurons in level 4 clusters. Cell
types of each cluster are depicted on the x-axis and annotated to match clusters in (D). Hubs
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 38 ---
Winding et al. Page 38
were defined as having ≥20 in- or out-degree (≥20 presynaptic or postsynaptic partners,
respectively; based on the mean degree plus 1.5 standard deviations). (F) Cell classes of
in-out hubs (a-d). Most neurons were downstream or upstream of the memory and learning
center (gray semicircle, MB-related). Note that CN + MB-FBN indicates neurons that were
both CNs and MB-FBNs. One pair of pre-DNVNC neurons received direct MBON input. (G)
Pathways from SNs to output neurons with 6 or fewer hops, using a pairwise ≥1% input
threshold of the a-d graph. Plot displays a random selection of 100,000 paths from a total set
of 3.6 million paths.
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 39 ---
Winding et al. Page 39
Fig. 4. Multimodal sensory integration across the brain.
(A) Morphology of neurons in sensory circuits, identified using multihop a-d connectivity
from SNs or ANs. (B) Neuron similarity across sensory circuits using the Dice
Coefficient. Most 2nd-order neurons were distinct, whereas 3rd- and 4th-order neurons
were progressively more similar between modalities. (C) Cell classes in each sensory
circuit. Note that neurons can be shared across sensory modalities within 2nd- or 3rd-order
layers. (D) Schematic of a multihop signal cascade, which probabilistically propagates
signal polysynaptically from a user-defined source and endpoint based on synaptic weights
between neurons. (E) Signal cascades from sensory modalities to brain output neurons,
DNsVNC. The number of hops between these input and output neurons was quantified. (F)
The number of pathways with different lengths was quantified from individual sensory
modalities to individual DNsVNC. Most sensory signals propagating to DNsVNC used
multiple paths of differing lengths (short, medium, long). (G) Individual neurons were
classified as unimodal or multimodal, based on signal cascades from individual sensory
modalities. Most brain neurons integrated from multiple sensory types (multimodal),
whereas a few integrated from a single modality (unimodal). (H) The distance from sensory
input in unimodal or multimodal cells from (G) was quantified. (I) Signal cascades (up to
5 hops) from SNs or ANs of different modalities to the input neurons of the learning and
memory center, including dopaminergic neurons (DANs), octopaminergic neurons (OANs),
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 40 ---
Winding et al. Page 40
and neurons of unknown neurotransmitters (MBINs). All DANs, 33% of OANs, and 60% of
other MBINs received signals from all sensory modalities.
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 41 ---
Winding et al. Page 41
Fig. 5. Characterization of interhemispheric communication by bilateral and contralateral
neurons.
(A) Connectivity between left and right hemispheres, sorted within each hemisphere by
the cluster structure. (B) Fraction of contralateral a-d presynaptic sites per neuron. (C)
Morphology of ipsilateral, bilateral, and contralateral axon neurons with a-d synaptic
distribution (right-side neurons depicted to make contralateral arbors visible). (D) Most
bilateral axon neurons synapsed onto homologous neurons in both hemispheres, as indicated
by the high cosine similarity of their a-d connectivity to ipsilateral and contralateral
downstream partners (left). Three bins of cosine similarity values and the cell type
memberships of the downstream partners are displayed (right). (E) Connection probability
between left and right cell types using a-d edges. The highest connection probabilities were
observed between contralateral neurons in opposite brain hemispheres. (F) Reciprocal loops
were observed between homologous left- and right-hemisphere neurons. (G) Sensory signal
lateralization per cell class. Blue, neurons that received signals from both hemispheres;
orange, neurons that received signals from only one hemisphere. Notably, 46% of DNsSEZ
were lateralized (using either 8-hop or 5-hop cascades).
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 42 ---
Winding et al. Page 42
Fig. 6. Comprehensive recurrent pathways through the brain.
(A) Schematic of signal cascades starting from each cluster. (B) Signal cascades originating
at each level-7 cluster (along the diagonal) travel in both forward (above the diagonal)
and backward (below the diagonal). Signal cascades were based on a-d connectivity and
contained 2 hops maximum to restrict analysis to the lower bound of backward signals.
(C) Number of clusters or single cells that received cascade forward or backward signals
from clusters or single cells within clusters, respectively. (D) Recurrence in brain neurons.
Polysynaptic downstream partners of each brain neuron were identified with a-d cascades
(up to 5 hops). Recurrent partners sent multihop signal back to the source neuron, forming
a recurrent loop (left), and 41% of brain neurons engaged in at least one such recurrent
loop (right). (E) Quantification of recurrent pathways of different length between individual
neurons. (F) Recurrence was quantified for each cell class. (Right) a schematic of the
most recurrent cell types in the brain and their relation to conditioned stimulus (CS) and
unconditioned stimulus (US) during associative learning. The MBIN category was split into
OANs and DAN/MBIN, as they displayed different distributions of recurrence. Note that KC
recurrence is so low that the violin plot is not visible. (G) Recurrent partners of individual
MBINs are reported (i.e., all downstream partners, using 5-hop cascades, that send recurrent
signals back), including those of dopaminergic neurons (DANs), octopaminergic neurons
(OANs), and MBINs expressing unknown neurotransmitters. (H) Recurrent or parallel
efference copy signals from DNsVNC or DNsSEZ using 1- or 2-hop a-d connectivity.
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 43 ---
Winding et al. Page 43
Fig. 7. Investigation of brain-nerve cord interactions revealed direct connectivity between
ascending and descending neurons.
(A) Schematic of the Drosophila larva CNS (i) and how this topology corresponds to
different body segments (ii), involved in a diverse set of behaviors (iii). (B) Each row
represents an individual DNVNC pair with its associated upstream and downstream a-d
connectivity in the brain and its projections to the rest of the CNS. Upstream and
downstream partner plots (i, iii) depict the fraction of cell types 1 and 2 hops from each
DNVNC (color legend, bottom). **, indicates one DNVNC pair had no strong 2nd-order
partners in the brain. The projectome plot (ii) reports the number of DNVNC presynaptic
sites in each CNS region. Candidate behaviors are suggested based on known behaviors
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts
--- PAGE 44 ---
Winding et al. Page 44
described in (A, iii). DNsVNC were grouped either by candidate behavior or level 7
clusters (iv). These independent groupings were highly correlated (Cramer's V Correlation
Coefficient = 0.58). (C) Schematic of common recurrent and efference copy a-d pathways
observed in the brain with a focus on DNVNC connectivity. (D) Avenues of interaction
between the brain and VNC, DNsVNC, and ANs, focused on the A1 segment. (E) Premotor
neuron layers in A1. Layers are identified based on a pairwise 1% a-d input threshold (left).
Number of interneurons and ANs in each layer are reported (right). DNVNC targets refer to
A1 neurons postsynaptic to a DNVNC. (F) Sensory layers in A1. Number of interneurons
(green) and ANs (blue) are reported for each sensory layer and location of DNVNC targets
(red). (G) Connection probability (a-d) between DNsVNC and A1 cell types, and between
ANsA1 and brain output neurons. (H) A-d motifs involving DNsVNC and ANs in A1. The
simplest version of each motif is depicted above, but motifs involving 3, 4, and 5 nodes
were also assayed, which contained additional A1 interneurons or preoutput neurons in the
brain. (I) All zigzag motifs observed. Each bar represents the number of neurons in each
type and lines represent paths originating and ending at individual cells in each category.
(J) A zigzag motif with previously characterized DNsVNC on either side. This motif starts
at PDM-DN, whose acute stimulation elicits a stopping behavior, and ends at MDN, whose
acute stimulation causes animals to back up. Stop-backup is a common behavioral sequence
observed in the Drosophila larva.
Science. Author manuscript; available in PMC 2023 May 16.
Europe
PMC
Funders
Author
Manuscripts
Europe
PMC
Funders
Author
Manuscripts